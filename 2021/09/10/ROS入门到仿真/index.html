<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="写在前面的话首先我想声明的一点是，已经快被BUG和Ubuntu的狗屎输入法搞崩溃了，又加上这网络问题，外加之前调试的一堆代码，我也是尤其深刻体会到了那句“一切不加注释的代码都是屎山！！！”是在不想浪费时间，但心理确实烦的一批。。。 好了好了，经过一些不必要的时间，我现在成功的安装上了百度输入法，虽然之前很不情愿用，但现在看来：“真香！！！”。话不多说，让我们进入今天的主题：ROS的入门到仿真 第一">
<meta property="og:type" content="article">
<meta property="og:title" content="ROS入门到仿真">
<meta property="og:url" content="http://example.com/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/index.html">
<meta property="og:site_name" content="革Mean君">
<meta property="og:description" content="写在前面的话首先我想声明的一点是，已经快被BUG和Ubuntu的狗屎输入法搞崩溃了，又加上这网络问题，外加之前调试的一堆代码，我也是尤其深刻体会到了那句“一切不加注释的代码都是屎山！！！”是在不想浪费时间，但心理确实烦的一批。。。 好了好了，经过一些不必要的时间，我现在成功的安装上了百度输入法，虽然之前很不情愿用，但现在看来：“真香！！！”。话不多说，让我们进入今天的主题：ROS的入门到仿真 第一">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/b05ab7cd776d40c9bdbd618dcfb735e4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_9,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/0887f96536f64b0397306c656d97a567.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/56caad7b9d7e4fdcb690f43dc869a50e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/07fa663409bd47e18a958ef15227ca2f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="article:published_time" content="2021-09-09T16:00:00.000Z">
<meta property="article:modified_time" content="2022-01-19T08:03:25.242Z">
<meta property="article:author" content="Hou-baitang">
<meta property="article:tag" content="i don t know">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/b05ab7cd776d40c9bdbd618dcfb735e4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_9,color_FFFFFF,t_70,g_se,x_16">

<link rel="canonical" href="http://example.com/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ROS入门到仿真 | 革Mean君</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">革Mean君</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">我的个人博客，用来记录学习过程以及心得等有意义的事情  有问题可以联系2914360094@qq.com</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">12</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ROS入门到仿真
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-10 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-10T00:00:00+08:00">2021-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-19 16:03:25" itemprop="dateModified" datetime="2022-01-19T16:03:25+08:00">2022-01-19</time>
              </span>

          
            <span id="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/" class="post-meta-item leancloud_visitors" data-flag-title="ROS入门到仿真" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="写在前面的话"><a href="#写在前面的话" class="headerlink" title="写在前面的话"></a>写在前面的话</h3><p>首先我想声明的一点是，已经快被BUG和Ubuntu的狗屎输入法搞崩溃了，又加上这网络问题，外加之前调试的一堆代码，我也是尤其深刻体会到了那句“一切不加注释的代码都是屎山！！！”是在不想浪费时间，但心理确实烦的一批。。。</p>
<p>好了好了，经过一些不必要的时间，我现在成功的安装上了百度输入法，虽然之前很不情愿用，但现在看来：“真香！！！”。话不多说，让我们进入今天的主题：ROS的入门到仿真</p>
<h1 id="第一步-入门会很快的过一遍，并不会细讲！！！！"><a href="#第一步-入门会很快的过一遍，并不会细讲！！！！" class="headerlink" title="第一步 入门会很快的过一遍，并不会细讲！！！！"></a>第一步 入门会很快的过一遍，并不会细讲！！！！</h1><p>首先，我入门ROS看的是古月的21讲那个视频，<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1zt411G7Vn?from=search&seid=12682064544807082213&spm_id_from=333.337.0.0">具体链接在这里</a>，还有就是入门的话应该不会用很长的时间，一个星期已经足矣，建立在有编程基础，学过C和C++或者是Python的情况下。那么默认大家已经掌握了这些编程规则，毕竟学了C的话剩下两个入门应该不是问题，也会很快，接下来就先看一下大概的目录结构吧。<img src="https://img-blog.csdnimg.cn/b05ab7cd776d40c9bdbd618dcfb735e4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_9,color_FFFFFF,t_70,g_se,x_16"></p>
<p>这张图片展示的是我的工作空间，src里面的便是从入门开始要学习的有关ros的一些基础知识，具体文件的话我会想办法留下来，但是由于里面涉及到的一些编译规则的问题（具体学过CMake，Makefile的应该都清楚，即使像我一样只看了大约一个小时不到也应该明白一些），所以说演示成功的部分仅代表在我个人的电脑上可以成功运行，如果想要在你的电脑上成功运行的话，还得花一小会去改一些东西，或者直接将我的源码配套结合自己的理解直接改，不要怕，就是梭哈！！！[手动狗头]</p>
<h4 id="首先是topic的相关代码"><a href="#首先是topic的相关代码" class="headerlink" title="首先是topic的相关代码"></a>首先是topic的相关代码</h4><p>古月开篇讲的东西已经很明白了，所以这里就不做赘述。直接上源码（配合小海龟实现）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一行代码以#！开头叫做“shebang”也叫sha-bang/hashbang/pound-bang/hash-pling，其作用是指定解析器来执行脚本</span></span><br><span class="line"><span class="comment"># 第二行代码是用来指定文件编码为utf-8的 如果没有编码类型的声明将默认以ASCII编码处理</span></span><br><span class="line"><span class="comment"># 该例程将发布turtle1/cmd_vel话题，消息类型geometry_msgs::Twist</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">velocity_publisher</span>():</span><br><span class="line">    <span class="comment"># ROS节点初始化</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;velocity_publisher&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个Publisher，发布名为/turtle1/cmd_vel的topic，消息类型为geometry_msgs::Twist，队列长度10</span></span><br><span class="line">    turtle_vel_pub = rospy.Publisher(<span class="string">&#x27;/turtle2/cmd_vel&#x27;</span>, Twist, queue_size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设置循环的频率</span></span><br><span class="line">    rate = rospy.Rate(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        <span class="comment"># 初始化geometry_msgs::Twist类型的消息</span></span><br><span class="line">        vel_msg = Twist()</span><br><span class="line">        vel_msg.linear.x = <span class="number">0.5</span></span><br><span class="line">        vel_msg.angular.z = <span class="number">0.2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 发布消息</span></span><br><span class="line">        turtle_vel_pub.publish(vel_msg)</span><br><span class="line">        rospy.loginfo(<span class="string">&quot;Publsh turtle velocity command[%0.2f m/s, %0.2f rad/s]&quot;</span>,</span><br><span class="line">                      vel_msg.linear.x, vel_msg.angular.z)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 按照循环频率延时</span></span><br><span class="line">        rate.sleep()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        velocity_publisher()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里为什么选择Python其实很好理解，Python的话是不用编译的，不像是C++需要编译后才可以生成执行文件，这个具体Makefile应该会讲，不过还有一点事Python支持的ros功能不算多，换句话说很多功能的实现都是C++写的，所以入门的时候我把两种语言都学了。。。。</p>
<p>具体C++里面设置功能包，添加功能包，自己添加自己的功能包等一系列的操作可以自学，但古月都讲过，比较详细，《视觉SLAM十四讲》这本书也有所提及。</p>
<p>然后是位姿的相关代码，比较简单，配合古月的21讲都能看懂。这里就不展示具体实现，还是建议跟着视频自己手动敲一遍才能加深记忆有助于理解。仅放一些可能用到的源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#位姿信息？？可能是时间有点长不太记得了。</span></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.msg <span class="keyword">import</span> Pose</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_pose</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;pose&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    rospy.Subscriber(<span class="string">&#x27;/turtle2/pose&#x27;</span>, Pose, callback=INFO)</span><br><span class="line"></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">INFO</span>(<span class="params">msg</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Turtle pose: x:%0.6f, y:%0.6f&quot;</span>, msg.x, msg.y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    my_pose()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后是publisher的实现函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> topic.msg <span class="keyword">import</span> Self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">self_publisher</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;self_publisher&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line">    self_info_pub = rospy.Publisher(<span class="string">&#x27;/person_info&#x27;</span>, Self, queue_size=<span class="number">10</span>)</span><br><span class="line">    rate = rospy.Rate(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        <span class="comment"># 初始化topic::Self类型消息</span></span><br><span class="line">        self_msg = Self()</span><br><span class="line">        self_msg.name = <span class="string">&quot;HBT&quot;</span></span><br><span class="line">        self_msg.age = <span class="number">20</span></span><br><span class="line">        self_msg.sex = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        self_info_pub.publish(self_msg)</span><br><span class="line">        rospy.loginfo(<span class="string">&quot;Person message[%s,%d,%d]&quot;</span> % (</span><br><span class="line">            self_msg.name, self_msg.age, self_msg.sex))</span><br><span class="line"></span><br><span class="line">        rate.sleep()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        self_publisher()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>subscriber函数的实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> topic.msg <span class="keyword">import</span> Self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">self_subscriber</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&quot;self_subscriber&quot;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    rospy.Subscriber(<span class="string">&quot;/person_info&quot;</span>, Self, back)</span><br><span class="line">    <span class="comment"># 循环等待回调函数</span></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">back</span>(<span class="params">msg</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Subscriber message:name:%s,age:%d,sex:%d&quot;</span>,</span><br><span class="line">                  msg.name, msg.age, msg.sex)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    self_subscriber()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>键盘控制小海龟运动的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tty</span><br><span class="line"><span class="keyword">import</span> termios</span><br><span class="line"><span class="keyword">import</span> roslib</span><br><span class="line">roslib.load_manifest(<span class="string">&#x27;topic&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局变量</span></span><br><span class="line">cmd = Twist()</span><br><span class="line">pub = rospy.Publisher(<span class="string">&#x27;/cmd_vel&#x27;</span>, Twist)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keyboardLoop</span>():</span><br><span class="line">    <span class="comment"># 初始化</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;smartcar_teleop&#x27;</span>)</span><br><span class="line">    rate = rospy.Rate(rospy.get_param(<span class="string">&#x27;~hz&#x27;</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 速度变量</span></span><br><span class="line">    walk_vel_ = rospy.get_param(<span class="string">&#x27;walk_vel&#x27;</span>, <span class="number">0.5</span>)</span><br><span class="line">    run_vel_ = rospy.get_param(<span class="string">&#x27;run_vel&#x27;</span>, <span class="number">1.0</span>)</span><br><span class="line">    yaw_rate_ = rospy.get_param(<span class="string">&#x27;yaw_rate&#x27;</span>, <span class="number">1.0</span>)</span><br><span class="line">    yaw_rate_run_ = rospy.get_param(<span class="string">&#x27;yaw_rate_run&#x27;</span>, <span class="number">1.5</span>)</span><br><span class="line"></span><br><span class="line">    max_tv = walk_vel_</span><br><span class="line">    max_rv = yaw_rate_</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示提示信息</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Reading from keyboard&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Use WASD keys to control the robot&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Press Caps to move faster&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Press q to quit&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取按键循环</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        fd = sys.stdin.fileno()</span><br><span class="line">        old_settings = termios.tcgetattr(fd)</span><br><span class="line">        <span class="comment"># 不产生回显效果</span></span><br><span class="line">        old_settings[<span class="number">3</span>] = old_settings[<span class="number">3</span>] &amp; ~termios.ICANON &amp; ~termios.ECHO</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            tty.setraw(fd)</span><br><span class="line">            ch = sys.stdin.read(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ch == <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">            max_tv = walk_vel_</span><br><span class="line">            speed = <span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            max_tv = walk_vel_</span><br><span class="line">            speed = -<span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;W&#x27;</span>:</span><br><span class="line">            max_tv = run_vel_</span><br><span class="line">            speed = <span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            max_tv = run_vel_</span><br><span class="line">            speed = -<span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_run_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_run_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            max_tv = walk_vel_</span><br><span class="line">            max_rv = yaw_rate_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 发送消息</span></span><br><span class="line">        cmd.linear.x = speed * max_tv</span><br><span class="line">        cmd.angular.z = turn * max_rv</span><br><span class="line">        pub.publish(cmd)</span><br><span class="line">        rate.sleep()</span><br><span class="line">        <span class="comment"># 停止机器人</span></span><br><span class="line">        stop_robot()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stop_robot</span>():</span><br><span class="line">    cmd.linear.x = <span class="number">0.0</span></span><br><span class="line">    cmd.angular.z = <span class="number">0.0</span></span><br><span class="line">    pub.publish(cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        keyboardLoop()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>关于topic的讲解还是不在赘述，有时间的话在考虑好好写一篇吧。</p>
<h4 id="然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的"><a href="#然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的" class="headerlink" title="然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的"></a>然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"><span class="keyword">from</span> std_srvs.srv <span class="keyword">import</span> Trigger, TriggerResponse</span><br><span class="line"></span><br><span class="line">pubcommand = <span class="literal">False</span></span><br><span class="line">turtle_pub = rospy.Publisher(<span class="string">&#x27;/turtle2/cmd_vel&#x27;</span>, Twist, queue_size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">command_thread</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> pubcommand:</span><br><span class="line">            vel_msg = Twist()</span><br><span class="line">            vel_msg.linear.x = <span class="number">0.8</span></span><br><span class="line">            vel_msg.angular.y = <span class="number">0.5</span></span><br><span class="line">            turtle_pub.publish(vel_msg)</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">commandcallback</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">global</span> pubcommand</span><br><span class="line">    pubcommand = <span class="built_in">bool</span>(<span class="number">1</span>-pubcommand)</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Publishe turtle velocity command [%d]&quot;</span>, pubcommand)</span><br><span class="line">    <span class="keyword">return</span> TriggerResponse(<span class="number">1</span>, <span class="string">&quot;Change!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">command_srv</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;command_srv&#x27;</span>)</span><br><span class="line">    s = rospy.Service(<span class="string">&#x27;/command_srv&#x27;</span>, Trigger, commandcallback)</span><br><span class="line"></span><br><span class="line">    thread = threading.Thread(target=command_thread)</span><br><span class="line">    thread.start()</span><br><span class="line"></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    command_srv()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个是command的服务函数。</p>
<p>接下来是个人的Clint端和service端的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> service.srv <span class="keyword">import</span> Person, PersonRequest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person_client</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;person_client&#x27;</span>)</span><br><span class="line">    <span class="comment"># 发现/spawn服务后，创建一个服务客户端，连接名为/spawn的service</span></span><br><span class="line">    rospy.wait_for_service(<span class="string">&#x27;/show_person&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        person_client = rospy.ServiceProxy(<span class="string">&#x27;/show_person&#x27;</span>, Person)</span><br><span class="line">        response = person_client(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>, PersonRequest.boy)</span><br><span class="line">        <span class="keyword">return</span> response.result</span><br><span class="line">    <span class="keyword">except</span> rospy.ServiceException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Service call failed: %s&quot;</span> % e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Show person result : %s&quot;</span> % (person_client()))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> service.srv <span class="keyword">import</span> Person, PersonResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">personCallback</span>(<span class="params">req</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Person: name:%s  age:%d  sex:%d&quot;</span>,</span><br><span class="line">                  req.name, req.age, req.sex)</span><br><span class="line">    <span class="keyword">return</span> PersonResponse(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person_server</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;person_server&#x27;</span>)</span><br><span class="line">    <span class="comment"># 创建一个名为/show_person的server，注册回调函数personCallback</span></span><br><span class="line">    s = rospy.Service(<span class="string">&#x27;/show_person&#x27;</span>, Person, personCallback)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ready to show person informtion.&quot;</span>)</span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    person_server()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这两个脚本得配合使用应该是，现在只做总结吧。</p>
<p>然后是产生多个小海龟的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.srv <span class="keyword">import</span> Spawn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spawn</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;spawn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    rospy.wait_for_service(<span class="string">&#x27;/spawn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        add_turtle = rospy.ServiceProxy(<span class="string">&#x27;/spawn&#x27;</span>, Spawn)</span><br><span class="line"></span><br><span class="line">        response = add_turtle(<span class="number">2.0</span>, <span class="number">2.0</span>, <span class="number">0.0</span>, <span class="string">&#x27;turtle2&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> response.name</span><br><span class="line">    <span class="keyword">except</span> rospy.ServiceException <span class="keyword">as</span> error:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Service call failed:%s&#x27;</span>, error)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Spawn turtle successful name:%s&quot;</span>, spawn())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>emm，好像古月的也只能找到这么多了吧？？？</p>
<p>资源有限，接下来是仿真的一些了。</p>
<h1 id="第二步-仿真"><a href="#第二步-仿真" class="headerlink" title="第二步 仿真"></a>第二步 仿真</h1><p>仿真的其实也很简单，大都是类似的搬运，搬着搬着代码阅读能力也会提高的，加上自己手动写一些，理解也会更加深刻，这部分我是参考了<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ci4y1L7ZZ?from=search&seid=12682064544807082213&spm_id_from=333.337.0.0">奥特学院的视频加文档</a>,这个UP是非常不错的，</p>
<p>当时ROS入门之后这个up才开始做视频，所以说前面的很大一部分我都是直接跳过去的<img src="https://img-blog.csdnimg.cn/0887f96536f64b0397306c656d97a567.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>确实是一个很好的选择，只不过入门的知识讲的时间很长，但我当时确实时间不是很足的情况下就没有看。还是建议大家看一看的，赵老师YYDS！！！<a target="_blank" rel="noopener" href="http://www.autolabor.com.cn/book/ROSTutorials/">文档在这里</a>,这个好像是用Gitbook发的，然后本质上也是Markdown的书写方式，确实可以省很多时间，与其去研究World文档怎么编辑，还不如来花几分钟入门Markdown，一劳永逸。</p>
<p>首先得了解关于仿真的一些工具以及一些ros当中用于调试的工具，像是RVIZ和GAZEBO等一些基础的，还有rqt一些调试的工具之外，其他的还需要读者自己去了解，这里只会讲用到的一些工具。</p>
<p>要想跑仿真首先得是有一个建模的小车，这个小车是我根据奥特改的一个roscar，大体上还可以，只不过amcl定位不准确，地图漂移有些严重（这里是指运动一部分时间之后的累计误差）。</p>
<p>下面是建模的代码，文件以.xacro方式保存</p>
<p>小车的底盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;base&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;!-- Macro for inertia matrix --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;sphere_inertial_matrix&quot; params=&quot;m r&quot;&gt;</span><br><span class="line">        &lt;inertial&gt;</span><br><span class="line">            &lt;mass value=&quot;$&#123;m&#125;&quot; /&gt;</span><br><span class="line">            &lt;inertia ixx=&quot;$&#123;2*m*r*r/5&#125;&quot; ixy=&quot;0&quot; ixz=&quot;0&quot;</span><br><span class="line">                iyy=&quot;$&#123;2*m*r*r/5&#125;&quot; iyz=&quot;0&quot; </span><br><span class="line">                izz=&quot;$&#123;2*m*r*r/5&#125;&quot; /&gt;</span><br><span class="line">        &lt;/inertial&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xacro:macro name=&quot;cylinder_inertial_matrix&quot; params=&quot;m r h&quot;&gt;</span><br><span class="line">        &lt;inertial&gt;</span><br><span class="line">            &lt;mass value=&quot;$&#123;m&#125;&quot; /&gt;</span><br><span class="line">            &lt;inertia ixx=&quot;$&#123;m*(3*r*r+h*h)/12&#125;&quot; ixy = &quot;0&quot; ixz = &quot;0&quot;</span><br><span class="line">                iyy=&quot;$&#123;m*(3*r*r+h*h)/12&#125;&quot; iyz = &quot;0&quot;</span><br><span class="line">                izz=&quot;$&#123;m*r*r/2&#125;&quot; /&gt; </span><br><span class="line">        &lt;/inertial&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xacro:macro name=&quot;Box_inertial_matrix&quot; params=&quot;m l w h&quot;&gt;</span><br><span class="line">       &lt;inertial&gt;</span><br><span class="line">               &lt;mass value=&quot;$&#123;m&#125;&quot; /&gt;</span><br><span class="line">               &lt;inertia ixx=&quot;$&#123;m*(h*h + l*l)/12&#125;&quot; ixy = &quot;0&quot; ixz = &quot;0&quot;</span><br><span class="line">                   iyy=&quot;$&#123;m*(w*w + l*l)/12&#125;&quot; iyz= &quot;0&quot;</span><br><span class="line">                   izz=&quot;$&#123;m*(w*w + h*h)/12&#125;&quot; /&gt;</span><br><span class="line">       &lt;/inertial&gt;</span><br><span class="line">   &lt;/xacro:macro&gt;</span><br><span class="line">&lt;/robot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 摄像头相关的 xacro 文件 --&gt;</span><br><span class="line">&lt;robot name=&quot;my_camera&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;!-- 摄像头属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_length&quot; value=&quot;0.01&quot; /&gt; &lt;!-- 摄像头长度(x) --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_width&quot; value=&quot;0.025&quot; /&gt; &lt;!-- 摄像头宽度(y) --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_height&quot; value=&quot;0.025&quot; /&gt; &lt;!-- 摄像头高度(z) --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_x&quot; value=&quot;0.08&quot; /&gt; &lt;!-- 摄像头安装的x坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_y&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 摄像头安装的y坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_z&quot; value=&quot;$&#123;base_link_length / 2 + camera_height / 2&#125;&quot; /&gt; &lt;!-- 摄像头安装的z坐标:底盘高度 / 2 + 摄像头高度 / 2  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_mass&quot; value=&quot;0.08&quot; /&gt;</span><br><span class="line">    &lt;!-- 摄像头关节以及link --&gt;</span><br><span class="line">    &lt;link name=&quot;camera&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;box size=&quot;$&#123;camera_length&#125; $&#123;camera_width&#125; $&#123;camera_height&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;box size=&quot;$&#123;camera_length&#125; $&#123;camera_width&#125; $&#123;camera_height&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:Box_inertial_matrix m=&quot;$&#123;camera_mass&#125;&quot; l=&quot;$&#123;camera_length&#125;&quot; w=&quot;$&#123;camera_width&#125;&quot; h=&quot;$&#123;camera_height&#125;&quot; /&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;camera&quot;&gt;</span><br><span class="line">    &lt;material&gt;</span><br><span class="line">        Gazebo/Black</span><br><span class="line">    &lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;camera2base_link&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;camera&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;$&#123;camera_x&#125; $&#123;camera_y&#125; $&#123;camera_z&#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>然后是雷达</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    小车底盘添加雷达</span><br><span class="line">--&gt;</span><br><span class="line">&lt;robot name=&quot;my_laser&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 雷达支架 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_length&quot; value=&quot;0.15&quot; /&gt; &lt;!-- 支架长度 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_radius&quot; value=&quot;0.01&quot; /&gt; &lt;!-- 支架半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_x&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 支架安装的x坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_y&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 支架安装的y坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_z&quot; value=&quot;$&#123;base_link_length / 2 + support_length / 2&#125;&quot; /&gt; &lt;!-- 支架安装的z坐标:底盘高度 / 2 + 支架高度 / 2  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_mass&quot; value=&quot;0.15&quot; /&gt;</span><br><span class="line">    &lt;link name=&quot;support&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;support_radius&#125;&quot; length=&quot;$&#123;support_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;red&quot;&gt;</span><br><span class="line">                &lt;color rgba=&quot;0.8 0.2 0.0 0.8&quot; /&gt;</span><br><span class="line">            &lt;/material&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;support_radius&#125;&quot; length=&quot;$&#123;support_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;support_mass&#125;&quot; r=&quot;$&#123;support_radius&#125;&quot; h=&quot;$&#123;support_length&#125;&quot;/&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;support&quot;&gt;</span><br><span class="line">        &lt;material&gt;</span><br><span class="line">            Gazebo/Red</span><br><span class="line">        &lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;support2base_link&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;support&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;$&#123;support_x&#125; $&#123;support_y&#125; $&#123;support_z&#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- 雷达属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_length&quot; value=&quot;0.05&quot; /&gt; &lt;!-- 雷达长度 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_radius&quot; value=&quot;0.03&quot; /&gt; &lt;!-- 雷达半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_x&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 雷达安装的x坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_y&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 雷达安装的y坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_z&quot; value=&quot;$&#123;support_length / 2 + laser_length / 2&#125;&quot; /&gt; &lt;!-- 雷达安装的z坐标:支架高度 / 2 + 雷达高度 / 2  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_mass&quot; value=&quot;0.5&quot; /&gt;</span><br><span class="line">    &lt;!-- 雷达关节以及link --&gt;</span><br><span class="line">    &lt;link name=&quot;laser&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;laser_radius&#125;&quot; length=&quot;$&#123;laser_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;laser_radius&#125;&quot; length=&quot;$&#123;laser_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;laser_mass&#125;&quot; r=&quot;$&#123;laser_radius&#125;&quot; h=&quot;$&#123;laser_length&#125;&quot;/&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;laser&quot;&gt;</span><br><span class="line">    &lt;material&gt;</span><br><span class="line">        Gazebo/Black</span><br><span class="line">    &lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;laser2support&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;support&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;laser&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;$&#123;laser_x&#125; $&#123;laser_y&#125; $&#123;laser_z&#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>深度相机（可以理解为传感器）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_sensors&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;support&quot;&gt;  </span><br><span class="line">      &lt;sensor type=&quot;depth&quot; name=&quot;camera&quot;&gt;</span><br><span class="line">        &lt;always_on&gt;true&lt;/always_on&gt;</span><br><span class="line">        &lt;update_rate&gt;20.0&lt;/update_rate&gt;</span><br><span class="line">        &lt;camera&gt;</span><br><span class="line">          &lt;horizontal_fov&gt;$&#123;60.0*PI/180.0&#125;&lt;/horizontal_fov&gt;</span><br><span class="line">          &lt;image&gt;</span><br><span class="line">            &lt;format&gt;R8G8B8&lt;/format&gt;</span><br><span class="line">            &lt;width&gt;640&lt;/width&gt;</span><br><span class="line">            &lt;height&gt;480&lt;/height&gt;</span><br><span class="line">          &lt;/image&gt;</span><br><span class="line">          &lt;clip&gt;</span><br><span class="line">            &lt;near&gt;0.05&lt;/near&gt;</span><br><span class="line">            &lt;far&gt;8.0&lt;/far&gt;</span><br><span class="line">          &lt;/clip&gt;</span><br><span class="line">        &lt;/camera&gt;</span><br><span class="line">        &lt;plugin name=&quot;kinect_camera_controller&quot; filename=&quot;libgazebo_ros_openni_kinect.so&quot;&gt;</span><br><span class="line">          &lt;cameraName&gt;camera&lt;/cameraName&gt;</span><br><span class="line">          &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;</span><br><span class="line">          &lt;updateRate&gt;10&lt;/updateRate&gt;</span><br><span class="line">          &lt;imageTopicName&gt;rgb/image_raw&lt;/imageTopicName&gt;</span><br><span class="line">          &lt;depthImageTopicName&gt;depth/image_raw&lt;/depthImageTopicName&gt;</span><br><span class="line">          &lt;pointCloudTopicName&gt;depth/points&lt;/pointCloudTopicName&gt;</span><br><span class="line">          &lt;cameraInfoTopicName&gt;rgb/camera_info&lt;/cameraInfoTopicName&gt;</span><br><span class="line">          &lt;depthImageCameraInfoTopicName&gt;depth/camera_info&lt;/depthImageCameraInfoTopicName&gt;</span><br><span class="line">          &lt;frameName&gt;support&lt;/frameName&gt;</span><br><span class="line">          &lt;baseline&gt;0.1&lt;/baseline&gt;</span><br><span class="line">          &lt;distortion_k1&gt;0.0&lt;/distortion_k1&gt;</span><br><span class="line">          &lt;distortion_k2&gt;0.0&lt;/distortion_k2&gt;</span><br><span class="line">          &lt;distortion_k3&gt;0.0&lt;/distortion_k3&gt;</span><br><span class="line">          &lt;distortion_t1&gt;0.0&lt;/distortion_t1&gt;</span><br><span class="line">          &lt;distortion_t2&gt;0.0&lt;/distortion_t2&gt;</span><br><span class="line">          &lt;pointCloudCutoff&gt;0.4&lt;/pointCloudCutoff&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">      &lt;/sensor&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接下来就是小车静态底盘的实现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    使用 xacro 优化 URDF 版的小车底盘实现：</span><br><span class="line"></span><br><span class="line">    实现思路:</span><br><span class="line">    1.将一些常量、变量封装为 xacro:property</span><br><span class="line">      比如:PI 值、小车底盘半径、离地间距、车轮半径、宽度 ....</span><br><span class="line">    2.使用 宏 封装驱动轮以及支撑轮实现，调用相关宏生成驱动轮与支撑轮</span><br><span class="line"></span><br><span class="line">--&gt;</span><br><span class="line">&lt;!-- 根标签，必须声明 xmlns:xacro --&gt;</span><br><span class="line">&lt;robot name=&quot;my_base&quot; xmlns:xacro=&quot;http://www.ros.org/wiki/xacro&quot;&gt;</span><br><span class="line">    &lt;!-- 封装变量、常量 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;PI&quot; value=&quot;3.141592653579&quot;/&gt;</span><br><span class="line">    &lt;!-- 宏:黑色设置 --&gt;</span><br><span class="line">    &lt;material name=&quot;black&quot;&gt;</span><br><span class="line">        &lt;color rgba=&quot;0.0 0.0 0.0 1.0&quot; /&gt;</span><br><span class="line">    &lt;/material&gt;</span><br><span class="line">    &lt;!-- 底盘属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_footprint_radius&quot; value=&quot;0.001&quot; /&gt; &lt;!-- base_footprint 半径  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_link_radius&quot; value=&quot;0.1&quot; /&gt; &lt;!-- base_link 半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_link_length&quot; value=&quot;0.08&quot; /&gt; &lt;!-- base_link 长 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_mass&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;earth_space&quot; value=&quot;0.015&quot; /&gt; &lt;!-- 离地间距 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 底盘 --&gt;</span><br><span class="line">    &lt;link name=&quot;base_footprint&quot;&gt;</span><br><span class="line">      &lt;visual&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">          &lt;sphere radius=&quot;$&#123;base_footprint_radius&#125;&quot; /&gt;</span><br><span class="line">        &lt;/geometry&gt;</span><br><span class="line">      &lt;/visual&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line"></span><br><span class="line">    &lt;link name=&quot;base_link&quot;&gt;</span><br><span class="line">      &lt;visual&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">          &lt;cylinder radius=&quot;$&#123;base_link_radius&#125;&quot; length=&quot;$&#123;base_link_length&#125;&quot; /&gt;</span><br><span class="line">        &lt;/geometry&gt;</span><br><span class="line">        &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">        &lt;material name=&quot;yellow&quot;&gt;</span><br><span class="line">          &lt;color rgba=&quot;0.5 0.3 0.0 0.5&quot; /&gt;</span><br><span class="line">        &lt;/material&gt;</span><br><span class="line">      &lt;/visual&gt;</span><br><span class="line">      &lt;collision&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">          &lt;cylinder radius=&quot;$&#123;base_link_radius&#125;&quot; length=&quot;$&#123;base_link_length&#125;&quot; /&gt;</span><br><span class="line">        &lt;/geometry&gt;</span><br><span class="line">        &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">      &lt;/collision&gt;</span><br><span class="line">      &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;base_mass&#125;&quot; r=&quot;$&#123;base_link_radius&#125;&quot; h=&quot;$&#123;base_link_length&#125;&quot;/&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;base_link&quot;&gt;</span><br><span class="line">        &lt;material&gt;Gazebo/Yellow&lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;base_link2base_footprint&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">      &lt;parent link=&quot;base_footprint&quot; /&gt;</span><br><span class="line">      &lt;child link=&quot;base_link&quot; /&gt;</span><br><span class="line">      &lt;origin xyz=&quot;0 0 $&#123;earth_space + base_link_length / 2 &#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 驱动轮 --&gt;</span><br><span class="line">    &lt;!-- 驱动轮属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;wheel_radius&quot; value=&quot;0.0325&quot; /&gt;&lt;!-- 半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;wheel_length&quot; value=&quot;0.015&quot; /&gt;&lt;!-- 宽度 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;wheel_mass&quot; value=&quot;0.05&quot; /&gt;</span><br><span class="line">    &lt;!-- 驱动轮宏实现 --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;add_wheels&quot; params=&quot;name flag&quot;&gt;</span><br><span class="line">      &lt;link name=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">          &lt;geometry&gt;</span><br><span class="line">            &lt;cylinder radius=&quot;$&#123;wheel_radius&#125;&quot; length=&quot;$&#123;wheel_length&#125;&quot; /&gt;</span><br><span class="line">          &lt;/geometry&gt;</span><br><span class="line">          &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;$&#123;PI / 2&#125; 0.0 0.0&quot; /&gt;</span><br><span class="line">          &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">           &lt;geometry&gt;</span><br><span class="line">            &lt;cylinder radius=&quot;$&#123;wheel_radius&#125;&quot; length=&quot;$&#123;wheel_length&#125;&quot; /&gt;</span><br><span class="line">          &lt;/geometry&gt;</span><br><span class="line">          &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;$&#123;PI / 2&#125; 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;wheel_mass&#125;&quot; r=&quot;$&#123;wheel_radius&#125;&quot; h=&quot;$&#123;wheel_length&#125;&quot; /&gt;</span><br><span class="line">      &lt;/link&gt;</span><br><span class="line">      &lt;gazebo reference=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">        &lt;material&gt;Gazebo/Black&lt;/material&gt;</span><br><span class="line">      &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">      &lt;joint name=&quot;$&#123;name&#125;_wheel2base_link&quot; type=&quot;continuous&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;$&#123;name&#125;_wheel&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;0 $&#123;flag * base_link_radius&#125; $&#123;-(earth_space + base_link_length / 2 - wheel_radius) &#125;&quot; /&gt;</span><br><span class="line">        &lt;axis xyz=&quot;0 1 0&quot; /&gt;</span><br><span class="line">      &lt;/joint&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line">    &lt;xacro:add_wheels name=&quot;left&quot; flag=&quot;1&quot; /&gt;</span><br><span class="line">    &lt;xacro:add_wheels name=&quot;right&quot; flag=&quot;-1&quot; /&gt;</span><br><span class="line">    &lt;!-- 支撑轮 --&gt;</span><br><span class="line">    &lt;!-- 支撑轮属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_wheel_radius&quot; value=&quot;0.0075&quot; /&gt; &lt;!-- 支撑轮半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_wheel_mass&quot; value=&quot;0.01&quot; /&gt;</span><br><span class="line">    &lt;!-- 支撑轮宏 --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;add_support_wheel&quot; params=&quot;name flag&quot; &gt;</span><br><span class="line">      &lt;link name=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;sphere radius=&quot;$&#123;support_wheel_radius&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;sphere radius=&quot;$&#123;support_wheel_radius&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:sphere_inertial_matrix m=&quot;$&#123;support_wheel_mass&#125;&quot; r=&quot;$&#123;support_wheel_radius&#125;&quot; /&gt;</span><br><span class="line">      &lt;/link&gt;</span><br><span class="line">      &lt;gazebo reference=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">          &lt;material&gt;Gazebo/Black&lt;/material&gt;</span><br><span class="line">      &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">      &lt;joint name=&quot;$&#123;name&#125;_wheel2base_link&quot; type=&quot;continuous&quot;&gt;</span><br><span class="line">          &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">          &lt;child link=&quot;$&#123;name&#125;_wheel&quot; /&gt;</span><br><span class="line">          &lt;origin xyz=&quot;$&#123;flag * (base_link_radius - support_wheel_radius)&#125; 0 $&#123;-(base_link_length / 2 + earth_space / 2)&#125;&quot; /&gt;</span><br><span class="line">          &lt;axis xyz=&quot;1 1 1&quot; /&gt;</span><br><span class="line">      &lt;/joint&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xacro:add_support_wheel name=&quot;front&quot; flag=&quot;1&quot; /&gt;</span><br><span class="line">    &lt;xacro:add_support_wheel name=&quot;back&quot; flag=&quot;-1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>要想要底盘实现机械运动到目前为止还是远远不够的，必须再加上控制的代码才能实现小车的运动。</p>
<p>摄像头控制代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_sensors&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">  &lt;!-- 被引用的link --&gt;</span><br><span class="line">  &lt;gazebo reference=&quot;camera&quot;&gt;</span><br><span class="line">    &lt;!-- 类型设置为 camara --&gt;</span><br><span class="line">    &lt;sensor type=&quot;camera&quot; name=&quot;camera_node&quot;&gt;</span><br><span class="line">      &lt;update_rate&gt;30.0&lt;/update_rate&gt; &lt;!-- 更新频率 --&gt;</span><br><span class="line">      &lt;!-- 摄像头基本信息设置 --&gt;</span><br><span class="line">      &lt;camera name=&quot;head&quot;&gt;</span><br><span class="line">        &lt;horizontal_fov&gt;1.3962634&lt;/horizontal_fov&gt;</span><br><span class="line">        &lt;image&gt;</span><br><span class="line">          &lt;width&gt;1280&lt;/width&gt;</span><br><span class="line">          &lt;height&gt;720&lt;/height&gt;</span><br><span class="line">          &lt;format&gt;R8G8B8&lt;/format&gt;</span><br><span class="line">        &lt;/image&gt;</span><br><span class="line">        &lt;clip&gt;</span><br><span class="line">          &lt;near&gt;0.02&lt;/near&gt;</span><br><span class="line">          &lt;far&gt;300&lt;/far&gt;</span><br><span class="line">        &lt;/clip&gt;</span><br><span class="line">        &lt;noise&gt;</span><br><span class="line">          &lt;type&gt;gaussian&lt;/type&gt;</span><br><span class="line">          &lt;mean&gt;0.0&lt;/mean&gt;</span><br><span class="line">          &lt;stddev&gt;0.007&lt;/stddev&gt;</span><br><span class="line">        &lt;/noise&gt;</span><br><span class="line">      &lt;/camera&gt;</span><br><span class="line">      &lt;!-- 核心插件 --&gt;</span><br><span class="line">      &lt;plugin name=&quot;gazebo_camera&quot; filename=&quot;libgazebo_ros_camera.so&quot;&gt;</span><br><span class="line">        &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;</span><br><span class="line">        &lt;updateRate&gt;0.0&lt;/updateRate&gt;</span><br><span class="line">        &lt;cameraName&gt;/camera&lt;/cameraName&gt;</span><br><span class="line">        &lt;imageTopicName&gt;image_raw&lt;/imageTopicName&gt;</span><br><span class="line">        &lt;cameraInfoTopicName&gt;camera_info&lt;/cameraInfoTopicName&gt;</span><br><span class="line">        &lt;frameName&gt;camera&lt;/frameName&gt;</span><br><span class="line">        &lt;hackBaseline&gt;0.07&lt;/hackBaseline&gt;</span><br><span class="line">        &lt;distortionK1&gt;0.0&lt;/distortionK1&gt;</span><br><span class="line">        &lt;distortionK2&gt;0.0&lt;/distortionK2&gt;</span><br><span class="line">        &lt;distortionK3&gt;0.0&lt;/distortionK3&gt;</span><br><span class="line">        &lt;distortionT1&gt;0.0&lt;/distortionT1&gt;</span><br><span class="line">        &lt;distortionT2&gt;0.0&lt;/distortionT2&gt;</span><br><span class="line">      &lt;/plugin&gt;</span><br><span class="line">    &lt;/sensor&gt;</span><br><span class="line">  &lt;/gazebo&gt;</span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>雷达控制代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_sensors&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 雷达 --&gt;</span><br><span class="line">  &lt;gazebo reference=&quot;laser&quot;&gt;</span><br><span class="line">    &lt;sensor type=&quot;ray&quot; name=&quot;rplidar&quot;&gt;</span><br><span class="line">      &lt;pose&gt;0 0 0 0 0 0&lt;/pose&gt;</span><br><span class="line">      &lt;visualize&gt;true&lt;/visualize&gt;</span><br><span class="line">      &lt;update_rate&gt;5.5&lt;/update_rate&gt;</span><br><span class="line">      &lt;ray&gt;</span><br><span class="line">        &lt;scan&gt;</span><br><span class="line">          &lt;horizontal&gt;</span><br><span class="line">            &lt;samples&gt;360&lt;/samples&gt;</span><br><span class="line">            &lt;resolution&gt;1&lt;/resolution&gt;</span><br><span class="line">            &lt;min_angle&gt;-3.1415926&lt;/min_angle&gt;</span><br><span class="line">            &lt;max_angle&gt;3.1415926&lt;/max_angle&gt;</span><br><span class="line">          &lt;/horizontal&gt;</span><br><span class="line">        &lt;/scan&gt;</span><br><span class="line">        &lt;range&gt;</span><br><span class="line">          &lt;min&gt;0.10&lt;/min&gt;</span><br><span class="line">          &lt;max&gt;30.0&lt;/max&gt;</span><br><span class="line">          &lt;resolution&gt;0.01&lt;/resolution&gt;</span><br><span class="line">        &lt;/range&gt;</span><br><span class="line">        &lt;noise&gt;</span><br><span class="line">          &lt;type&gt;gaussian&lt;/type&gt;</span><br><span class="line">          &lt;mean&gt;0.0&lt;/mean&gt;</span><br><span class="line">          &lt;stddev&gt;0.01&lt;/stddev&gt;</span><br><span class="line">        &lt;/noise&gt;</span><br><span class="line">      &lt;/ray&gt;</span><br><span class="line">      &lt;plugin name=&quot;gazebo_rplidar&quot; filename=&quot;libgazebo_ros_laser.so&quot;&gt;</span><br><span class="line">        &lt;topicName&gt;/scan&lt;/topicName&gt;</span><br><span class="line">        &lt;frameName&gt;laser&lt;/frameName&gt;</span><br><span class="line">      &lt;/plugin&gt;</span><br><span class="line">    &lt;/sensor&gt;</span><br><span class="line">  &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>最后是连接起整个小车的综合代码，可以理解为一个将各个组件拼接在一起的文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 组合小车底盘与摄像头 --&gt;</span><br><span class="line">&lt;robot name=&quot;mycar&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;base.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;car.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;camera.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;laser.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;car_move.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;ctrl_camera.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;ctrl_laser.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;kinect.xacro&quot; /&gt;</span><br><span class="line">&lt;/robot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>小车的物理属性都创建好了之后就可以让他按照一定的物理属性运动啦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_car_move&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 传动实现:用于连接控制器与关节 --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;joint_trans&quot; params=&quot;joint_name&quot;&gt;</span><br><span class="line">        &lt;!-- Transmission is important to link the joints and the controller --&gt;</span><br><span class="line">        &lt;transmission name=&quot;$&#123;joint_name&#125;_trans&quot;&gt;</span><br><span class="line">            &lt;type&gt;transmission_interface/SimpleTransmission&lt;/type&gt;</span><br><span class="line">            &lt;joint name=&quot;$&#123;joint_name&#125;&quot;&gt;</span><br><span class="line">                &lt;hardwareInterface&gt;hardware_interface/VelocityJointInterface&lt;/hardwareInterface&gt;</span><br><span class="line">            &lt;/joint&gt;</span><br><span class="line">            &lt;actuator name=&quot;$&#123;joint_name&#125;_motor&quot;&gt;</span><br><span class="line">                &lt;hardwareInterface&gt;hardware_interface/VelocityJointInterface&lt;/hardwareInterface&gt;</span><br><span class="line">                &lt;mechanicalReduction&gt;1&lt;/mechanicalReduction&gt;</span><br><span class="line">            &lt;/actuator&gt;</span><br><span class="line">        &lt;/transmission&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 每一个驱动轮都需要配置传动装置 --&gt;</span><br><span class="line">    &lt;xacro:joint_trans joint_name=&quot;left_wheel2base_link&quot; /&gt;</span><br><span class="line">    &lt;xacro:joint_trans joint_name=&quot;right_wheel2base_link&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 控制器 --&gt;</span><br><span class="line">    &lt;gazebo&gt;</span><br><span class="line">        &lt;plugin name=&quot;differential_drive_controller&quot; filename=&quot;libgazebo_ros_diff_drive.so&quot;&gt;</span><br><span class="line">            &lt;rosDebugLevel&gt;Debug&lt;/rosDebugLevel&gt;</span><br><span class="line">            &lt;publishWheelTF&gt;true&lt;/publishWheelTF&gt;</span><br><span class="line">            &lt;robotNamespace&gt;/&lt;/robotNamespace&gt;</span><br><span class="line">            &lt;publishTf&gt;1&lt;/publishTf&gt;</span><br><span class="line">            &lt;publishWheelJointState&gt;true&lt;/publishWheelJointState&gt;</span><br><span class="line">            &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;</span><br><span class="line">            &lt;updateRate&gt;100.0&lt;/updateRate&gt;</span><br><span class="line">            &lt;legacyMode&gt;true&lt;/legacyMode&gt;</span><br><span class="line">            &lt;leftJoint&gt;left_wheel2base_link&lt;/leftJoint&gt; &lt;!-- 左轮 --&gt;</span><br><span class="line">            &lt;rightJoint&gt;right_wheel2base_link&lt;/rightJoint&gt; &lt;!-- 右轮 --&gt;</span><br><span class="line">            &lt;wheelSeparation&gt;$&#123;base_link_radius * 2&#125;&lt;/wheelSeparation&gt; &lt;!-- 车轮间距 --&gt;</span><br><span class="line">            &lt;wheelDiameter&gt;$&#123;wheel_radius * 2&#125;&lt;/wheelDiameter&gt; &lt;!-- 车轮直径 --&gt;</span><br><span class="line">            &lt;broadcastTF&gt;1&lt;/broadcastTF&gt;</span><br><span class="line">            &lt;wheelTorque&gt;30&lt;/wheelTorque&gt;</span><br><span class="line">            &lt;wheelAcceleration&gt;1.8&lt;/wheelAcceleration&gt;</span><br><span class="line">            &lt;commandTopic&gt;/cmd_vel&lt;/commandTopic&gt; &lt;!-- 运动控制话题 --&gt;</span><br><span class="line">            &lt;odometryFrame&gt;odom&lt;/odometryFrame&gt; </span><br><span class="line">            &lt;odometryTopic&gt;/odom&lt;/odometryTopic&gt; &lt;!-- 里程计话题 --&gt;</span><br><span class="line">            &lt;robotBaseFrame&gt;base_footprint&lt;/robotBaseFrame&gt; &lt;!-- 根坐标系 --&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>具体的API也可以仿照官网Wiki的文件自己配置，配置过程无非就是把调用的借口放在一个实现方式的里面，再加上参数就可以啦。</p>
<p>emm，URDF的文件找不到在哪了，可能是之前重装系统的时候删掉了，毕竟现在展示的代码都是在那之后又自己写的。。所以说有好多都没有加注释。。。</p>
<p>其实配置仿真大部分都用的是官方的接口，所以说难度不大，要说有难度的还得是自己写适配于自己的设备的代码，到时候不仅要运动学分析，正逆解算还得学矩阵论相关，坐标变换等，这都是我入门阶段所了解到的一些内容，具体应用到实际的话肯定不止我纸面上写的这么一点而已，所以说学无止境。</p>
<p>配置查分小车的launch文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;amcl&quot;</span> <span class="attr">type</span>=<span class="string">&quot;amcl&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amcl&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Publish scans from best pose at a max of 10 Hz --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_model_type&quot;</span> <span class="attr">value</span>=<span class="string">&quot;diff&quot;</span>/&gt;</span><span class="comment">&lt;!-- 里程计模式为差分 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha5&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;transform_tolerance&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;gui_publish_rate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10.0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_max_beams&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;min_particles&quot;</span> <span class="attr">value</span>=<span class="string">&quot;500&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;max_particles&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5000&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;kld_err&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;kld_z&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.99&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- translation std dev, m --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha4&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_hit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_short&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_rand&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_sigma_hit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_lambda_short&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_lambda_short&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_model_type&quot;</span> <span class="attr">value</span>=<span class="string">&quot;likelihood_field&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;param name=&quot;laser_model_type&quot; value=&quot;beam&quot;/&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_likelihood_max_dist&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2.0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;update_min_d&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;update_min_a&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 移植只需修改参数即可 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_frame_id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;odom&quot;</span>/&gt;</span><span class="comment">&lt;!-- 里程计坐标系 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;base_frame_id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;base_footprint&quot;</span>/&gt;</span><span class="comment">&lt;!-- 添加机器人基坐标系 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;global_frame_id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;map&quot;</span>/&gt;</span><span class="comment">&lt;!-- 添加地图坐标系 --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;resample_interval&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;transform_tolerance&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;recovery_alpha_slow&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;recovery_alpha_fast&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后我就按照我文件的默认位置写啦，具体的注释都有讲解，该怎么配置也都写得很详细</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">&lt;!--是否设置为仿真，在仿真环境里面使用  true  --&gt;</span><br><span class="line">&lt;param name=&quot;use_sim_time&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;!-- gampping 节点 --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find my_navigation)/launch/gampping.launch&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- 可以保存 rviz 配置并后期直接使用--&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find my_navigation)/rviz/demo_amcl.rviz&quot;/&gt;</span><br><span class="line">   </span><br><span class="line">    &lt;!-- 将 Urdf 文件的内容加载到参数服务器 --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)/xacro $(find my_gazebo)/xacro/connect.xacro&quot; /&gt;</span><br><span class="line">    &lt;!-- 启动 gazebo --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;&gt;</span><br><span class="line">       &lt;arg name=&quot;world_name&quot; value=&quot;$(find my_gazebo)/worlds/1.world&quot; /&gt;</span><br><span class="line">    &lt;/include&gt; --&gt;</span><br><span class="line">    &lt;!-- 在 gazebo 中显示机器人模型 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gazebo_ros&quot; type=&quot;spawn_model&quot; name=&quot;model&quot; args=&quot;-urdf -model mycar -param robot_description&quot;  /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面的是进行AMCL的代码，接下来是跑gmapping的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">  &lt;!--是否设置为仿真，在仿真环境里面使用  true  --&gt;</span><br><span class="line">  &lt;param name=&quot;use_sim_time&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;include file=&quot;$(find my_navigation)/launch/gampping.launch&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- 可以保存 rviz 配置并后期直接使用--&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find my_navigation)/rviz/demo1.rviz&quot;/&gt;</span><br><span class="line">   </span><br><span class="line">    &lt;!-- 将 Urdf 文件的内容加载到参数服务器 --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)/xacro $(find my_gazebo)/xacro/connect.xacro&quot; /&gt;</span><br><span class="line">    &lt;!-- 启动 gazebo --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;&gt;</span><br><span class="line">       &lt;arg name=&quot;world_name&quot; value=&quot;$(find my_gazebo)/worlds/1.world&quot; /&gt;</span><br><span class="line">    &lt;/include&gt; --&gt;</span><br><span class="line">    &lt;!-- 在 gazebo 中显示机器人模型 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gazebo_ros&quot; type=&quot;spawn_model&quot; name=&quot;model&quot; args=&quot;-urdf -model mycar -param robot_description&quot;  /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要配合gmapping的配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- gampping 节点 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gmapping&quot; type=&quot;slam_gmapping&quot; name=&quot;slam_gmapping&quot; output=&quot;screen&quot;&gt;</span><br><span class="line">      &lt;!-- 设置雷达话题 --&gt;</span><br><span class="line">      &lt;remap from=&quot;scan&quot; to=&quot;scan&quot;/&gt;</span><br><span class="line">      &lt;!-- 关键参数  三个坐标系 --&gt;</span><br><span class="line">      &lt;param name=&quot;base_frame&quot; value=&quot;base_footprint&quot;/&gt;&lt;!--底盘坐标系 设置为基坐标系名字 在这里是 base_footprint --&gt;</span><br><span class="line">      &lt;param name=&quot;odom_frame&quot; value=&quot;odom&quot;/&gt; &lt;!--里程计坐标系--&gt;</span><br><span class="line">      &lt;param name=&quot;map_update_interval&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">      &lt;!-- 其他参数一般设置为默认即可（下面为默认参数值） --&gt;</span><br><span class="line">      &lt;param name=&quot;maxUrange&quot; value=&quot;16.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;sigma&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;kernelSize&quot; value=&quot;1&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lstep&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;astep&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;iterations&quot; value=&quot;5&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lsigma&quot; value=&quot;0.075&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;ogain&quot; value=&quot;3.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lskip&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;srr&quot; value=&quot;0.1&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;srt&quot; value=&quot;0.2&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;str&quot; value=&quot;0.1&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;stt&quot; value=&quot;0.2&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;linearUpdate&quot; value=&quot;1.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;angularUpdate&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;temporalUpdate&quot; value=&quot;3.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;resampleThreshold&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;particles&quot; value=&quot;30&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;xmin&quot; value=&quot;-50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;ymin&quot; value=&quot;-50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;xmax&quot; value=&quot;50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;ymax&quot; value=&quot;50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;delta&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;llsamplerange&quot; value=&quot;0.01&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;llsamplestep&quot; value=&quot;0.01&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lasamplerange&quot; value=&quot;0.005&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lasamplestep&quot; value=&quot;0.005&quot;/&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"></span><br><span class="line">    &lt;node pkg=&quot;joint_state_publisher&quot; name=&quot;joint_state_publisher&quot; type=&quot;joint_state_publisher&quot; /&gt;</span><br><span class="line">    &lt;node pkg=&quot;robot_state_publisher&quot; name=&quot;robot_state_publisher&quot; type=&quot;robot_state_publisher&quot; /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>建图操作和保存地图操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- 设置地图的配置文件 --&gt;</span><br><span class="line">    &lt;arg name=&quot;map&quot; default=&quot;nav.yaml&quot; /&gt;</span><br><span class="line">    &lt;!-- 运行地图服务器，并且加载设置的地图--&gt;</span><br><span class="line">    &lt;node name=&quot;map_server&quot; pkg=&quot;map_server&quot; type=&quot;map_server&quot; args=&quot;$(find my_navigation)/map/$(arg map)&quot;/&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>然后是保存操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;arg name=&quot;filename&quot; value=&quot;$(find my_navigation)/map/nav&quot; /&gt;</span><br><span class="line">    &lt;node name=&quot;map_save&quot; pkg=&quot;map_server&quot; type=&quot;map_saver&quot; args=&quot;-f $(arg filename)&quot; /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>move_base相关代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line"></span><br><span class="line">    &lt;node pkg=&quot;move_base&quot; type=&quot;move_base&quot; respawn=&quot;false&quot; name=&quot;move_base&quot; output=&quot;screen&quot; clear_params=&quot;true&quot;&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/costmap_common_params.yaml&quot; command=&quot;load&quot; ns=&quot;global_costmap&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/costmap_common_params.yaml&quot; command=&quot;load&quot; ns=&quot;local_costmap&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/local_costmap_params.yaml&quot; command=&quot;load&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/global_costmap_params.yaml&quot; command=&quot;load&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/base_local_planner_params.yaml&quot; command=&quot;load&quot; /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"></span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后一步是跑整个建图之后的导航的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- 设置地图的配置文件 --&gt;</span><br><span class="line">    &lt;arg name=&quot;map&quot; default=&quot;nav.yaml&quot; /&gt;</span><br><span class="line">    &lt;!-- 运行地图服务器，并且加载设置的地图--&gt;</span><br><span class="line">    &lt;node name=&quot;map_server&quot; pkg=&quot;map_server&quot; type=&quot;map_server&quot; args=&quot;$(find roscar_navigation)/map/$(arg map)&quot;/&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- 启动SLAM --&gt;</span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find roscar_navigation)/launch/gmapping.launch&quot; /&gt; --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- 启动AMCL节点 二维地图定位 --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find roscar_navigation)/launch/amcl_diff.launch&quot; /&gt;</span><br><span class="line">    &lt;!-- 使用官方虚拟定位兼容AMCL输出 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;fake_localization&quot; type=&quot;fake_localization&quot; name=&quot;fake_localization&quot; output=&quot;screen&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 运行move_base节点 --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find roscar_navigation)/launch/move_base.launch&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;node pkg=&quot;joint_state_publisher&quot; name=&quot;joint_state_publisher&quot; type=&quot;joint_state_publisher&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;robot_state_publisher&quot; name=&quot;robot_state_publisher&quot; type=&quot;robot_state_publisher&quot; /&gt; --&gt;</span><br><span class="line">    &lt;node name=&quot;robot_state_publisher&quot; pkg=&quot;robot_state_publisher&quot; type=&quot;robot_state_publisher&quot;  output=&quot;screen&quot; &gt;</span><br><span class="line">        &lt;param name=&quot;publish_frequency&quot; type=&quot;double&quot; value=&quot;50.0&quot; /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- 可以保存 rviz 配置并后期直接使用--&gt; </span><br><span class="line">    &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find roscar_navigation)/rviz/demo_self_move.rviz&quot;/&gt;  </span><br><span class="line">    &lt;!-- 将 Urdf 文件的内容加载到参数服务器 --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)/xacro $(find roscar_gazebo)/xacro/connect.xacro&quot; /&gt;</span><br><span class="line">    &lt;!-- 启动 gazebo --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;&gt;</span><br><span class="line">       &lt;arg name=&quot;world_name&quot; value=&quot;$(find roscar_gazebo)/worlds/roscar_demo.world&quot; /&gt;</span><br><span class="line">    &lt;/include&gt; --&gt;</span><br><span class="line">    &lt;!-- 在 gazebo 中显示机器人模型 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gazebo_ros&quot; type=&quot;spawn_model&quot; name=&quot;model&quot; args=&quot;-urdf -model mycar -param robot_description&quot;  /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 对于虚拟定位，需要设置一个/odom与/map之间的静态坐标变换  前六个参数分别是xyz和rpy,10代表10ms刷新一次--&gt;</span><br><span class="line">    &lt;node pkg=&quot;tf&quot; type=&quot;static_transform_publisher&quot; name=&quot;map_odom_broadcaster&quot; args=&quot;0 0 0 0 0 0 /map /odom 10&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>具体效果如图</p>
<p><img src="https://img-blog.csdnimg.cn/56caad7b9d7e4fdcb690f43dc869a50e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br><img src="https://img-blog.csdnimg.cn/07fa663409bd47e18a958ef15227ca2f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<p>写在最后：以上代码的代码文件可以问我要，具体可以实现导航的在roscar_navigation里面launch文件的self_move.launch 中，其他补充的话还需要完善</p>
<p>未完待续。。。。。。</p>

    </div>

    
    
    
        <div class="reward-container">
  <div>如果觉得有帮助的话可以对我进行打赏哦~</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/weichat.jpg" alt="Hou-baitang 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Hou-baitang 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/04/18/ROS%E4%B8%8ESTM32%E9%80%9A%E4%BF%A1/" rel="prev" title="ROS&STM32通信">
      <i class="fa fa-chevron-left"></i> ROS&STM32通信
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/26/%E8%A7%A3%E5%86%B3Linux%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/" rel="next" title="解决Linux下安装CH340驱动报错问题">
      解决Linux下安装CH340驱动报错问题 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D"><span class="nav-number">1.</span> <span class="nav-text">写在前面的话</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5-%E5%85%A5%E9%97%A8%E4%BC%9A%E5%BE%88%E5%BF%AB%E7%9A%84%E8%BF%87%E4%B8%80%E9%81%8D%EF%BC%8C%E5%B9%B6%E4%B8%8D%E4%BC%9A%E7%BB%86%E8%AE%B2%EF%BC%81%EF%BC%81%EF%BC%81%EF%BC%81"><span class="nav-number"></span> <span class="nav-text">第一步 入门会很快的过一遍，并不会细讲！！！！</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A6%96%E5%85%88%E6%98%AFtopic%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BB%A3%E7%A0%81"><span class="nav-number">0.1.</span> <span class="nav-text">首先是topic的相关代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%84%B6%E5%90%8E%E6%98%AFservice%E7%9A%84%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0%EF%BC%8C%E8%BF%98%E6%98%AF%E5%8F%AA%E8%BF%87%E4%B8%80%E9%81%8D%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%85%B7%E4%BD%93%E5%AD%A6%E4%B9%A0%E5%8F%82%E8%80%83%E5%8F%A4%E6%9C%88%E7%9A%8421%E8%AE%B2%E6%88%91%E6%84%9F%E8%A7%89%E5%B0%B1%E6%8C%BA%E5%A5%BD%E7%9A%84"><span class="nav-number">0.2.</span> <span class="nav-text">然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E4%BB%BF%E7%9C%9F"><span class="nav-number"></span> <span class="nav-text">第二步 仿真</span></a></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hou-baitang"
      src="/images/01.jpg">
  <p class="site-author-name" itemprop="name">Hou-baitang</p>
  <div class="site-description" itemprop="description">用于记录学习生活，成为一个自己想要成为的人</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/2914360094@qq.com" title="E-Mail → 2914360094@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hou-baitang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'CHrcBwX6gcXANbBEKYs61u5W-gzGzoHsz',
      appKey     : 'vWEYMt0YeFAFL8Xp2TDI0Lhn',
      placeholder: "快来评论叭~~",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
