<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"baitang-hou.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="用于记录学习生活，成为一个自己想要成为的人">
<meta property="og:type" content="website">
<meta property="og:title" content="革Mean君">
<meta property="og:url" content="https://baitang-hou.github.io/page/2/index.html">
<meta property="og:site_name" content="革Mean君">
<meta property="og:description" content="用于记录学习生活，成为一个自己想要成为的人">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Hou-baitang">
<meta property="article:tag" content="i don t know">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://baitang-hou.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>革Mean君</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">革Mean君</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">我的个人博客，用来记录学习过程以及心得等有意义的事情  有问题可以联系2914360094@qq.com</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">16</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://baitang-hou.github.io/2022/01/26/%E8%A7%A3%E5%86%B3Linux%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/26/%E8%A7%A3%E5%86%B3Linux%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">解决Linux下安装CH340驱动报错问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-26 00:00:00" itemprop="dateCreated datePublished" datetime="2022-01-26T00:00:00+08:00">2022-01-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-27 09:18:40" itemprop="dateModified" datetime="2022-01-27T09:18:40+08:00">2022-01-27</time>
              </span>

          
            <span id="/2022/01/26/%E8%A7%A3%E5%86%B3Linux%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/" class="post-meta-item leancloud_visitors" data-flag-title="解决Linux下安装CH340驱动报错问题" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/26/%E8%A7%A3%E5%86%B3Linux%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/26/%E8%A7%A3%E5%86%B3Linux%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>@<a href="%E6%B0%B8%E4%B9%85%E8%A7%A3%E5%86%B3Linux%EF%BC%88Ubuntu%EF%BC%89%E4%B8%8B%E5%AE%89%E8%A3%85CH340%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98">TOC0</a></p>
<h1 id="出现的问题"><a href="#出现的问题" class="headerlink" title="出现的问题"></a>出现的问题</h1><p>当我们用make对CH340的文件进行构建的时候，大多数情况是会报这样的错误<br><img src="https://img-blog.csdnimg.cn/3993e103d5e84608adecb0a088ac1d59.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>下面提供一种永久解决的方法</p>
<ul>
<li>首先打开下载安装的文件<br>  <img src="https://img-blog.csdnimg.cn/c698be377f4944d9970e93672c8f94eb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></li>
<li>然后分别做出以下改变<br>  1,添加头文件<br>  <img src="https://img-blog.csdnimg.cn/10c89e7e6c104a3b9dd71ecbee25f6fe.png" alt="请添加图片描述"></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;linux/sched/signal.h&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2,屏蔽掉该语句（592行）<br><img src="https://img-blog.csdnimg.cn/45a27087a837480f99c30f239b288532.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>保存之后退出<br>然后我们再重新进入终端运行make<br><img src="https://img-blog.csdnimg.cn/78844d90f1c9438bba1a297aeecd620c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>这样的话就可以找到串口了<br><img src="https://img-blog.csdnimg.cn/9a051e01a361489289cd642c0f045bd7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://baitang-hou.github.io/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/" class="post-title-link" itemprop="url">ROS入门到仿真</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-10 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-10T00:00:00+08:00">2021-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-19 16:03:25" itemprop="dateModified" datetime="2022-01-19T16:03:25+08:00">2022-01-19</time>
              </span>

          
            <span id="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/" class="post-meta-item leancloud_visitors" data-flag-title="ROS入门到仿真" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/09/10/ROS%E5%85%A5%E9%97%A8%E5%88%B0%E4%BB%BF%E7%9C%9F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="写在前面的话"><a href="#写在前面的话" class="headerlink" title="写在前面的话"></a>写在前面的话</h3><p>首先我想声明的一点是，已经快被BUG和Ubuntu的狗屎输入法搞崩溃了，又加上这网络问题，外加之前调试的一堆代码，我也是尤其深刻体会到了那句“一切不加注释的代码都是屎山！！！”是在不想浪费时间，但心理确实烦的一批。。。</p>
<p>好了好了，经过一些不必要的时间，我现在成功的安装上了百度输入法，虽然之前很不情愿用，但现在看来：“真香！！！”。话不多说，让我们进入今天的主题：ROS的入门到仿真</p>
<h1 id="第一步-入门会很快的过一遍，并不会细讲！！！！"><a href="#第一步-入门会很快的过一遍，并不会细讲！！！！" class="headerlink" title="第一步 入门会很快的过一遍，并不会细讲！！！！"></a>第一步 入门会很快的过一遍，并不会细讲！！！！</h1><p>首先，我入门ROS看的是古月的21讲那个视频，<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1zt411G7Vn?from=search&seid=12682064544807082213&spm_id_from=333.337.0.0">具体链接在这里</a>，还有就是入门的话应该不会用很长的时间，一个星期已经足矣，建立在有编程基础，学过C和C++或者是Python的情况下。那么默认大家已经掌握了这些编程规则，毕竟学了C的话剩下两个入门应该不是问题，也会很快，接下来就先看一下大概的目录结构吧。<img src="https://img-blog.csdnimg.cn/b05ab7cd776d40c9bdbd618dcfb735e4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_9,color_FFFFFF,t_70,g_se,x_16"></p>
<p>这张图片展示的是我的工作空间，src里面的便是从入门开始要学习的有关ros的一些基础知识，具体文件的话我会想办法留下来，但是由于里面涉及到的一些编译规则的问题（具体学过CMake，Makefile的应该都清楚，即使像我一样只看了大约一个小时不到也应该明白一些），所以说演示成功的部分仅代表在我个人的电脑上可以成功运行，如果想要在你的电脑上成功运行的话，还得花一小会去改一些东西，或者直接将我的源码配套结合自己的理解直接改，不要怕，就是梭哈！！！[手动狗头]</p>
<h4 id="首先是topic的相关代码"><a href="#首先是topic的相关代码" class="headerlink" title="首先是topic的相关代码"></a>首先是topic的相关代码</h4><p>古月开篇讲的东西已经很明白了，所以这里就不做赘述。直接上源码（配合小海龟实现）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一行代码以#！开头叫做“shebang”也叫sha-bang/hashbang/pound-bang/hash-pling，其作用是指定解析器来执行脚本</span></span><br><span class="line"><span class="comment"># 第二行代码是用来指定文件编码为utf-8的 如果没有编码类型的声明将默认以ASCII编码处理</span></span><br><span class="line"><span class="comment"># 该例程将发布turtle1/cmd_vel话题，消息类型geometry_msgs::Twist</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">velocity_publisher</span>():</span><br><span class="line">    <span class="comment"># ROS节点初始化</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;velocity_publisher&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个Publisher，发布名为/turtle1/cmd_vel的topic，消息类型为geometry_msgs::Twist，队列长度10</span></span><br><span class="line">    turtle_vel_pub = rospy.Publisher(<span class="string">&#x27;/turtle2/cmd_vel&#x27;</span>, Twist, queue_size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设置循环的频率</span></span><br><span class="line">    rate = rospy.Rate(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        <span class="comment"># 初始化geometry_msgs::Twist类型的消息</span></span><br><span class="line">        vel_msg = Twist()</span><br><span class="line">        vel_msg.linear.x = <span class="number">0.5</span></span><br><span class="line">        vel_msg.angular.z = <span class="number">0.2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 发布消息</span></span><br><span class="line">        turtle_vel_pub.publish(vel_msg)</span><br><span class="line">        rospy.loginfo(<span class="string">&quot;Publsh turtle velocity command[%0.2f m/s, %0.2f rad/s]&quot;</span>,</span><br><span class="line">                      vel_msg.linear.x, vel_msg.angular.z)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 按照循环频率延时</span></span><br><span class="line">        rate.sleep()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        velocity_publisher()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里为什么选择Python其实很好理解，Python的话是不用编译的，不像是C++需要编译后才可以生成执行文件，这个具体Makefile应该会讲，不过还有一点事Python支持的ros功能不算多，换句话说很多功能的实现都是C++写的，所以入门的时候我把两种语言都学了。。。。</p>
<p>具体C++里面设置功能包，添加功能包，自己添加自己的功能包等一系列的操作可以自学，但古月都讲过，比较详细，《视觉SLAM十四讲》这本书也有所提及。</p>
<p>然后是位姿的相关代码，比较简单，配合古月的21讲都能看懂。这里就不展示具体实现，还是建议跟着视频自己手动敲一遍才能加深记忆有助于理解。仅放一些可能用到的源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#位姿信息？？可能是时间有点长不太记得了。</span></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.msg <span class="keyword">import</span> Pose</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_pose</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;pose&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    rospy.Subscriber(<span class="string">&#x27;/turtle2/pose&#x27;</span>, Pose, callback=INFO)</span><br><span class="line"></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">INFO</span>(<span class="params">msg</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Turtle pose: x:%0.6f, y:%0.6f&quot;</span>, msg.x, msg.y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    my_pose()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后是publisher的实现函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> topic.msg <span class="keyword">import</span> Self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">self_publisher</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;self_publisher&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line">    self_info_pub = rospy.Publisher(<span class="string">&#x27;/person_info&#x27;</span>, Self, queue_size=<span class="number">10</span>)</span><br><span class="line">    rate = rospy.Rate(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        <span class="comment"># 初始化topic::Self类型消息</span></span><br><span class="line">        self_msg = Self()</span><br><span class="line">        self_msg.name = <span class="string">&quot;HBT&quot;</span></span><br><span class="line">        self_msg.age = <span class="number">20</span></span><br><span class="line">        self_msg.sex = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        self_info_pub.publish(self_msg)</span><br><span class="line">        rospy.loginfo(<span class="string">&quot;Person message[%s,%d,%d]&quot;</span> % (</span><br><span class="line">            self_msg.name, self_msg.age, self_msg.sex))</span><br><span class="line"></span><br><span class="line">        rate.sleep()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        self_publisher()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>subscriber函数的实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> topic.msg <span class="keyword">import</span> Self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">self_subscriber</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&quot;self_subscriber&quot;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    rospy.Subscriber(<span class="string">&quot;/person_info&quot;</span>, Self, back)</span><br><span class="line">    <span class="comment"># 循环等待回调函数</span></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">back</span>(<span class="params">msg</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Subscriber message:name:%s,age:%d,sex:%d&quot;</span>,</span><br><span class="line">                  msg.name, msg.age, msg.sex)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    self_subscriber()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>键盘控制小海龟运动的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tty</span><br><span class="line"><span class="keyword">import</span> termios</span><br><span class="line"><span class="keyword">import</span> roslib</span><br><span class="line">roslib.load_manifest(<span class="string">&#x27;topic&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局变量</span></span><br><span class="line">cmd = Twist()</span><br><span class="line">pub = rospy.Publisher(<span class="string">&#x27;/cmd_vel&#x27;</span>, Twist)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keyboardLoop</span>():</span><br><span class="line">    <span class="comment"># 初始化</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;smartcar_teleop&#x27;</span>)</span><br><span class="line">    rate = rospy.Rate(rospy.get_param(<span class="string">&#x27;~hz&#x27;</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 速度变量</span></span><br><span class="line">    walk_vel_ = rospy.get_param(<span class="string">&#x27;walk_vel&#x27;</span>, <span class="number">0.5</span>)</span><br><span class="line">    run_vel_ = rospy.get_param(<span class="string">&#x27;run_vel&#x27;</span>, <span class="number">1.0</span>)</span><br><span class="line">    yaw_rate_ = rospy.get_param(<span class="string">&#x27;yaw_rate&#x27;</span>, <span class="number">1.0</span>)</span><br><span class="line">    yaw_rate_run_ = rospy.get_param(<span class="string">&#x27;yaw_rate_run&#x27;</span>, <span class="number">1.5</span>)</span><br><span class="line"></span><br><span class="line">    max_tv = walk_vel_</span><br><span class="line">    max_rv = yaw_rate_</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示提示信息</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Reading from keyboard&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Use WASD keys to control the robot&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Press Caps to move faster&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Press q to quit&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取按键循环</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        fd = sys.stdin.fileno()</span><br><span class="line">        old_settings = termios.tcgetattr(fd)</span><br><span class="line">        <span class="comment"># 不产生回显效果</span></span><br><span class="line">        old_settings[<span class="number">3</span>] = old_settings[<span class="number">3</span>] &amp; ~termios.ICANON &amp; ~termios.ECHO</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            tty.setraw(fd)</span><br><span class="line">            ch = sys.stdin.read(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ch == <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">            max_tv = walk_vel_</span><br><span class="line">            speed = <span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            max_tv = walk_vel_</span><br><span class="line">            speed = -<span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;W&#x27;</span>:</span><br><span class="line">            max_tv = run_vel_</span><br><span class="line">            speed = <span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            max_tv = run_vel_</span><br><span class="line">            speed = -<span class="number">1</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_run_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">            max_rv = yaw_rate_run_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ch == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            max_tv = walk_vel_</span><br><span class="line">            max_rv = yaw_rate_</span><br><span class="line">            speed = <span class="number">0</span></span><br><span class="line">            turn = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 发送消息</span></span><br><span class="line">        cmd.linear.x = speed * max_tv</span><br><span class="line">        cmd.angular.z = turn * max_rv</span><br><span class="line">        pub.publish(cmd)</span><br><span class="line">        rate.sleep()</span><br><span class="line">        <span class="comment"># 停止机器人</span></span><br><span class="line">        stop_robot()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stop_robot</span>():</span><br><span class="line">    cmd.linear.x = <span class="number">0.0</span></span><br><span class="line">    cmd.angular.z = <span class="number">0.0</span></span><br><span class="line">    pub.publish(cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        keyboardLoop()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>关于topic的讲解还是不在赘述，有时间的话在考虑好好写一篇吧。</p>
<h4 id="然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的"><a href="#然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的" class="headerlink" title="然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的"></a>然后是service的相关函数，还是只过一遍代码，具体学习参考古月的21讲我感觉就挺好的</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"><span class="keyword">from</span> std_srvs.srv <span class="keyword">import</span> Trigger, TriggerResponse</span><br><span class="line"></span><br><span class="line">pubcommand = <span class="literal">False</span></span><br><span class="line">turtle_pub = rospy.Publisher(<span class="string">&#x27;/turtle2/cmd_vel&#x27;</span>, Twist, queue_size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">command_thread</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> pubcommand:</span><br><span class="line">            vel_msg = Twist()</span><br><span class="line">            vel_msg.linear.x = <span class="number">0.8</span></span><br><span class="line">            vel_msg.angular.y = <span class="number">0.5</span></span><br><span class="line">            turtle_pub.publish(vel_msg)</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">commandcallback</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">global</span> pubcommand</span><br><span class="line">    pubcommand = <span class="built_in">bool</span>(<span class="number">1</span>-pubcommand)</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Publishe turtle velocity command [%d]&quot;</span>, pubcommand)</span><br><span class="line">    <span class="keyword">return</span> TriggerResponse(<span class="number">1</span>, <span class="string">&quot;Change!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">command_srv</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;command_srv&#x27;</span>)</span><br><span class="line">    s = rospy.Service(<span class="string">&#x27;/command_srv&#x27;</span>, Trigger, commandcallback)</span><br><span class="line"></span><br><span class="line">    thread = threading.Thread(target=command_thread)</span><br><span class="line">    thread.start()</span><br><span class="line"></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    command_srv()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个是command的服务函数。</p>
<p>接下来是个人的Clint端和service端的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> service.srv <span class="keyword">import</span> Person, PersonRequest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person_client</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;person_client&#x27;</span>)</span><br><span class="line">    <span class="comment"># 发现/spawn服务后，创建一个服务客户端，连接名为/spawn的service</span></span><br><span class="line">    rospy.wait_for_service(<span class="string">&#x27;/show_person&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        person_client = rospy.ServiceProxy(<span class="string">&#x27;/show_person&#x27;</span>, Person)</span><br><span class="line">        response = person_client(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>, PersonRequest.boy)</span><br><span class="line">        <span class="keyword">return</span> response.result</span><br><span class="line">    <span class="keyword">except</span> rospy.ServiceException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Service call failed: %s&quot;</span> % e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Show person result : %s&quot;</span> % (person_client()))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> service.srv <span class="keyword">import</span> Person, PersonResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">personCallback</span>(<span class="params">req</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">&quot;Person: name:%s  age:%d  sex:%d&quot;</span>,</span><br><span class="line">                  req.name, req.age, req.sex)</span><br><span class="line">    <span class="keyword">return</span> PersonResponse(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person_server</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;person_server&#x27;</span>)</span><br><span class="line">    <span class="comment"># 创建一个名为/show_person的server，注册回调函数personCallback</span></span><br><span class="line">    s = rospy.Service(<span class="string">&#x27;/show_person&#x27;</span>, Person, personCallback)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ready to show person informtion.&quot;</span>)</span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    person_server()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这两个脚本得配合使用应该是，现在只做总结吧。</p>
<p>然后是产生多个小海龟的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.srv <span class="keyword">import</span> Spawn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spawn</span>():</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;spawn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    rospy.wait_for_service(<span class="string">&#x27;/spawn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        add_turtle = rospy.ServiceProxy(<span class="string">&#x27;/spawn&#x27;</span>, Spawn)</span><br><span class="line"></span><br><span class="line">        response = add_turtle(<span class="number">2.0</span>, <span class="number">2.0</span>, <span class="number">0.0</span>, <span class="string">&#x27;turtle2&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> response.name</span><br><span class="line">    <span class="keyword">except</span> rospy.ServiceException <span class="keyword">as</span> error:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Service call failed:%s&#x27;</span>, error)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Spawn turtle successful name:%s&quot;</span>, spawn())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>emm，好像古月的也只能找到这么多了吧？？？</p>
<p>资源有限，接下来是仿真的一些了。</p>
<h1 id="第二步-仿真"><a href="#第二步-仿真" class="headerlink" title="第二步 仿真"></a>第二步 仿真</h1><p>仿真的其实也很简单，大都是类似的搬运，搬着搬着代码阅读能力也会提高的，加上自己手动写一些，理解也会更加深刻，这部分我是参考了<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ci4y1L7ZZ?from=search&seid=12682064544807082213&spm_id_from=333.337.0.0">奥特学院的视频加文档</a>,这个UP是非常不错的，</p>
<p>当时ROS入门之后这个up才开始做视频，所以说前面的很大一部分我都是直接跳过去的<img src="https://img-blog.csdnimg.cn/0887f96536f64b0397306c656d97a567.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>确实是一个很好的选择，只不过入门的知识讲的时间很长，但我当时确实时间不是很足的情况下就没有看。还是建议大家看一看的，赵老师YYDS！！！<a target="_blank" rel="noopener" href="http://www.autolabor.com.cn/book/ROSTutorials/">文档在这里</a>,这个好像是用Gitbook发的，然后本质上也是Markdown的书写方式，确实可以省很多时间，与其去研究World文档怎么编辑，还不如来花几分钟入门Markdown，一劳永逸。</p>
<p>首先得了解关于仿真的一些工具以及一些ros当中用于调试的工具，像是RVIZ和GAZEBO等一些基础的，还有rqt一些调试的工具之外，其他的还需要读者自己去了解，这里只会讲用到的一些工具。</p>
<p>要想跑仿真首先得是有一个建模的小车，这个小车是我根据奥特改的一个roscar，大体上还可以，只不过amcl定位不准确，地图漂移有些严重（这里是指运动一部分时间之后的累计误差）。</p>
<p>下面是建模的代码，文件以.xacro方式保存</p>
<p>小车的底盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;base&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;!-- Macro for inertia matrix --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;sphere_inertial_matrix&quot; params=&quot;m r&quot;&gt;</span><br><span class="line">        &lt;inertial&gt;</span><br><span class="line">            &lt;mass value=&quot;$&#123;m&#125;&quot; /&gt;</span><br><span class="line">            &lt;inertia ixx=&quot;$&#123;2*m*r*r/5&#125;&quot; ixy=&quot;0&quot; ixz=&quot;0&quot;</span><br><span class="line">                iyy=&quot;$&#123;2*m*r*r/5&#125;&quot; iyz=&quot;0&quot; </span><br><span class="line">                izz=&quot;$&#123;2*m*r*r/5&#125;&quot; /&gt;</span><br><span class="line">        &lt;/inertial&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xacro:macro name=&quot;cylinder_inertial_matrix&quot; params=&quot;m r h&quot;&gt;</span><br><span class="line">        &lt;inertial&gt;</span><br><span class="line">            &lt;mass value=&quot;$&#123;m&#125;&quot; /&gt;</span><br><span class="line">            &lt;inertia ixx=&quot;$&#123;m*(3*r*r+h*h)/12&#125;&quot; ixy = &quot;0&quot; ixz = &quot;0&quot;</span><br><span class="line">                iyy=&quot;$&#123;m*(3*r*r+h*h)/12&#125;&quot; iyz = &quot;0&quot;</span><br><span class="line">                izz=&quot;$&#123;m*r*r/2&#125;&quot; /&gt; </span><br><span class="line">        &lt;/inertial&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xacro:macro name=&quot;Box_inertial_matrix&quot; params=&quot;m l w h&quot;&gt;</span><br><span class="line">       &lt;inertial&gt;</span><br><span class="line">               &lt;mass value=&quot;$&#123;m&#125;&quot; /&gt;</span><br><span class="line">               &lt;inertia ixx=&quot;$&#123;m*(h*h + l*l)/12&#125;&quot; ixy = &quot;0&quot; ixz = &quot;0&quot;</span><br><span class="line">                   iyy=&quot;$&#123;m*(w*w + l*l)/12&#125;&quot; iyz= &quot;0&quot;</span><br><span class="line">                   izz=&quot;$&#123;m*(w*w + h*h)/12&#125;&quot; /&gt;</span><br><span class="line">       &lt;/inertial&gt;</span><br><span class="line">   &lt;/xacro:macro&gt;</span><br><span class="line">&lt;/robot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 摄像头相关的 xacro 文件 --&gt;</span><br><span class="line">&lt;robot name=&quot;my_camera&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;!-- 摄像头属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_length&quot; value=&quot;0.01&quot; /&gt; &lt;!-- 摄像头长度(x) --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_width&quot; value=&quot;0.025&quot; /&gt; &lt;!-- 摄像头宽度(y) --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_height&quot; value=&quot;0.025&quot; /&gt; &lt;!-- 摄像头高度(z) --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_x&quot; value=&quot;0.08&quot; /&gt; &lt;!-- 摄像头安装的x坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_y&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 摄像头安装的y坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_z&quot; value=&quot;$&#123;base_link_length / 2 + camera_height / 2&#125;&quot; /&gt; &lt;!-- 摄像头安装的z坐标:底盘高度 / 2 + 摄像头高度 / 2  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;camera_mass&quot; value=&quot;0.08&quot; /&gt;</span><br><span class="line">    &lt;!-- 摄像头关节以及link --&gt;</span><br><span class="line">    &lt;link name=&quot;camera&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;box size=&quot;$&#123;camera_length&#125; $&#123;camera_width&#125; $&#123;camera_height&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;box size=&quot;$&#123;camera_length&#125; $&#123;camera_width&#125; $&#123;camera_height&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:Box_inertial_matrix m=&quot;$&#123;camera_mass&#125;&quot; l=&quot;$&#123;camera_length&#125;&quot; w=&quot;$&#123;camera_width&#125;&quot; h=&quot;$&#123;camera_height&#125;&quot; /&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;camera&quot;&gt;</span><br><span class="line">    &lt;material&gt;</span><br><span class="line">        Gazebo/Black</span><br><span class="line">    &lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;camera2base_link&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;camera&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;$&#123;camera_x&#125; $&#123;camera_y&#125; $&#123;camera_z&#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>然后是雷达</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    小车底盘添加雷达</span><br><span class="line">--&gt;</span><br><span class="line">&lt;robot name=&quot;my_laser&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 雷达支架 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_length&quot; value=&quot;0.15&quot; /&gt; &lt;!-- 支架长度 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_radius&quot; value=&quot;0.01&quot; /&gt; &lt;!-- 支架半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_x&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 支架安装的x坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_y&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 支架安装的y坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_z&quot; value=&quot;$&#123;base_link_length / 2 + support_length / 2&#125;&quot; /&gt; &lt;!-- 支架安装的z坐标:底盘高度 / 2 + 支架高度 / 2  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_mass&quot; value=&quot;0.15&quot; /&gt;</span><br><span class="line">    &lt;link name=&quot;support&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;support_radius&#125;&quot; length=&quot;$&#123;support_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;red&quot;&gt;</span><br><span class="line">                &lt;color rgba=&quot;0.8 0.2 0.0 0.8&quot; /&gt;</span><br><span class="line">            &lt;/material&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;support_radius&#125;&quot; length=&quot;$&#123;support_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;support_mass&#125;&quot; r=&quot;$&#123;support_radius&#125;&quot; h=&quot;$&#123;support_length&#125;&quot;/&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;support&quot;&gt;</span><br><span class="line">        &lt;material&gt;</span><br><span class="line">            Gazebo/Red</span><br><span class="line">        &lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;support2base_link&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;support&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;$&#123;support_x&#125; $&#123;support_y&#125; $&#123;support_z&#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- 雷达属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_length&quot; value=&quot;0.05&quot; /&gt; &lt;!-- 雷达长度 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_radius&quot; value=&quot;0.03&quot; /&gt; &lt;!-- 雷达半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_x&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 雷达安装的x坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_y&quot; value=&quot;0.0&quot; /&gt; &lt;!-- 雷达安装的y坐标 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_z&quot; value=&quot;$&#123;support_length / 2 + laser_length / 2&#125;&quot; /&gt; &lt;!-- 雷达安装的z坐标:支架高度 / 2 + 雷达高度 / 2  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;laser_mass&quot; value=&quot;0.5&quot; /&gt;</span><br><span class="line">    &lt;!-- 雷达关节以及link --&gt;</span><br><span class="line">    &lt;link name=&quot;laser&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;laser_radius&#125;&quot; length=&quot;$&#123;laser_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;cylinder radius=&quot;$&#123;laser_radius&#125;&quot; length=&quot;$&#123;laser_length&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;0.0 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;laser_mass&#125;&quot; r=&quot;$&#123;laser_radius&#125;&quot; h=&quot;$&#123;laser_length&#125;&quot;/&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;laser&quot;&gt;</span><br><span class="line">    &lt;material&gt;</span><br><span class="line">        Gazebo/Black</span><br><span class="line">    &lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;laser2support&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;support&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;laser&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;$&#123;laser_x&#125; $&#123;laser_y&#125; $&#123;laser_z&#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>深度相机（可以理解为传感器）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_sensors&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;support&quot;&gt;  </span><br><span class="line">      &lt;sensor type=&quot;depth&quot; name=&quot;camera&quot;&gt;</span><br><span class="line">        &lt;always_on&gt;true&lt;/always_on&gt;</span><br><span class="line">        &lt;update_rate&gt;20.0&lt;/update_rate&gt;</span><br><span class="line">        &lt;camera&gt;</span><br><span class="line">          &lt;horizontal_fov&gt;$&#123;60.0*PI/180.0&#125;&lt;/horizontal_fov&gt;</span><br><span class="line">          &lt;image&gt;</span><br><span class="line">            &lt;format&gt;R8G8B8&lt;/format&gt;</span><br><span class="line">            &lt;width&gt;640&lt;/width&gt;</span><br><span class="line">            &lt;height&gt;480&lt;/height&gt;</span><br><span class="line">          &lt;/image&gt;</span><br><span class="line">          &lt;clip&gt;</span><br><span class="line">            &lt;near&gt;0.05&lt;/near&gt;</span><br><span class="line">            &lt;far&gt;8.0&lt;/far&gt;</span><br><span class="line">          &lt;/clip&gt;</span><br><span class="line">        &lt;/camera&gt;</span><br><span class="line">        &lt;plugin name=&quot;kinect_camera_controller&quot; filename=&quot;libgazebo_ros_openni_kinect.so&quot;&gt;</span><br><span class="line">          &lt;cameraName&gt;camera&lt;/cameraName&gt;</span><br><span class="line">          &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;</span><br><span class="line">          &lt;updateRate&gt;10&lt;/updateRate&gt;</span><br><span class="line">          &lt;imageTopicName&gt;rgb/image_raw&lt;/imageTopicName&gt;</span><br><span class="line">          &lt;depthImageTopicName&gt;depth/image_raw&lt;/depthImageTopicName&gt;</span><br><span class="line">          &lt;pointCloudTopicName&gt;depth/points&lt;/pointCloudTopicName&gt;</span><br><span class="line">          &lt;cameraInfoTopicName&gt;rgb/camera_info&lt;/cameraInfoTopicName&gt;</span><br><span class="line">          &lt;depthImageCameraInfoTopicName&gt;depth/camera_info&lt;/depthImageCameraInfoTopicName&gt;</span><br><span class="line">          &lt;frameName&gt;support&lt;/frameName&gt;</span><br><span class="line">          &lt;baseline&gt;0.1&lt;/baseline&gt;</span><br><span class="line">          &lt;distortion_k1&gt;0.0&lt;/distortion_k1&gt;</span><br><span class="line">          &lt;distortion_k2&gt;0.0&lt;/distortion_k2&gt;</span><br><span class="line">          &lt;distortion_k3&gt;0.0&lt;/distortion_k3&gt;</span><br><span class="line">          &lt;distortion_t1&gt;0.0&lt;/distortion_t1&gt;</span><br><span class="line">          &lt;distortion_t2&gt;0.0&lt;/distortion_t2&gt;</span><br><span class="line">          &lt;pointCloudCutoff&gt;0.4&lt;/pointCloudCutoff&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">      &lt;/sensor&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接下来就是小车静态底盘的实现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    使用 xacro 优化 URDF 版的小车底盘实现：</span><br><span class="line"></span><br><span class="line">    实现思路:</span><br><span class="line">    1.将一些常量、变量封装为 xacro:property</span><br><span class="line">      比如:PI 值、小车底盘半径、离地间距、车轮半径、宽度 ....</span><br><span class="line">    2.使用 宏 封装驱动轮以及支撑轮实现，调用相关宏生成驱动轮与支撑轮</span><br><span class="line"></span><br><span class="line">--&gt;</span><br><span class="line">&lt;!-- 根标签，必须声明 xmlns:xacro --&gt;</span><br><span class="line">&lt;robot name=&quot;my_base&quot; xmlns:xacro=&quot;http://www.ros.org/wiki/xacro&quot;&gt;</span><br><span class="line">    &lt;!-- 封装变量、常量 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;PI&quot; value=&quot;3.141592653579&quot;/&gt;</span><br><span class="line">    &lt;!-- 宏:黑色设置 --&gt;</span><br><span class="line">    &lt;material name=&quot;black&quot;&gt;</span><br><span class="line">        &lt;color rgba=&quot;0.0 0.0 0.0 1.0&quot; /&gt;</span><br><span class="line">    &lt;/material&gt;</span><br><span class="line">    &lt;!-- 底盘属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_footprint_radius&quot; value=&quot;0.001&quot; /&gt; &lt;!-- base_footprint 半径  --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_link_radius&quot; value=&quot;0.1&quot; /&gt; &lt;!-- base_link 半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_link_length&quot; value=&quot;0.08&quot; /&gt; &lt;!-- base_link 长 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;base_mass&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;earth_space&quot; value=&quot;0.015&quot; /&gt; &lt;!-- 离地间距 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 底盘 --&gt;</span><br><span class="line">    &lt;link name=&quot;base_footprint&quot;&gt;</span><br><span class="line">      &lt;visual&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">          &lt;sphere radius=&quot;$&#123;base_footprint_radius&#125;&quot; /&gt;</span><br><span class="line">        &lt;/geometry&gt;</span><br><span class="line">      &lt;/visual&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line"></span><br><span class="line">    &lt;link name=&quot;base_link&quot;&gt;</span><br><span class="line">      &lt;visual&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">          &lt;cylinder radius=&quot;$&#123;base_link_radius&#125;&quot; length=&quot;$&#123;base_link_length&#125;&quot; /&gt;</span><br><span class="line">        &lt;/geometry&gt;</span><br><span class="line">        &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">        &lt;material name=&quot;yellow&quot;&gt;</span><br><span class="line">          &lt;color rgba=&quot;0.5 0.3 0.0 0.5&quot; /&gt;</span><br><span class="line">        &lt;/material&gt;</span><br><span class="line">      &lt;/visual&gt;</span><br><span class="line">      &lt;collision&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">          &lt;cylinder radius=&quot;$&#123;base_link_radius&#125;&quot; length=&quot;$&#123;base_link_length&#125;&quot; /&gt;</span><br><span class="line">        &lt;/geometry&gt;</span><br><span class="line">        &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">      &lt;/collision&gt;</span><br><span class="line">      &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;base_mass&#125;&quot; r=&quot;$&#123;base_link_radius&#125;&quot; h=&quot;$&#123;base_link_length&#125;&quot;/&gt;</span><br><span class="line">    &lt;/link&gt;</span><br><span class="line">    &lt;gazebo reference=&quot;base_link&quot;&gt;</span><br><span class="line">        &lt;material&gt;Gazebo/Yellow&lt;/material&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">    &lt;joint name=&quot;base_link2base_footprint&quot; type=&quot;fixed&quot;&gt;</span><br><span class="line">      &lt;parent link=&quot;base_footprint&quot; /&gt;</span><br><span class="line">      &lt;child link=&quot;base_link&quot; /&gt;</span><br><span class="line">      &lt;origin xyz=&quot;0 0 $&#123;earth_space + base_link_length / 2 &#125;&quot; /&gt;</span><br><span class="line">    &lt;/joint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 驱动轮 --&gt;</span><br><span class="line">    &lt;!-- 驱动轮属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;wheel_radius&quot; value=&quot;0.0325&quot; /&gt;&lt;!-- 半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;wheel_length&quot; value=&quot;0.015&quot; /&gt;&lt;!-- 宽度 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;wheel_mass&quot; value=&quot;0.05&quot; /&gt;</span><br><span class="line">    &lt;!-- 驱动轮宏实现 --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;add_wheels&quot; params=&quot;name flag&quot;&gt;</span><br><span class="line">      &lt;link name=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">          &lt;geometry&gt;</span><br><span class="line">            &lt;cylinder radius=&quot;$&#123;wheel_radius&#125;&quot; length=&quot;$&#123;wheel_length&#125;&quot; /&gt;</span><br><span class="line">          &lt;/geometry&gt;</span><br><span class="line">          &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;$&#123;PI / 2&#125; 0.0 0.0&quot; /&gt;</span><br><span class="line">          &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">           &lt;geometry&gt;</span><br><span class="line">            &lt;cylinder radius=&quot;$&#123;wheel_radius&#125;&quot; length=&quot;$&#123;wheel_length&#125;&quot; /&gt;</span><br><span class="line">          &lt;/geometry&gt;</span><br><span class="line">          &lt;origin xyz=&quot;0.0 0.0 0.0&quot; rpy=&quot;$&#123;PI / 2&#125; 0.0 0.0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:cylinder_inertial_matrix m=&quot;$&#123;wheel_mass&#125;&quot; r=&quot;$&#123;wheel_radius&#125;&quot; h=&quot;$&#123;wheel_length&#125;&quot; /&gt;</span><br><span class="line">      &lt;/link&gt;</span><br><span class="line">      &lt;gazebo reference=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">        &lt;material&gt;Gazebo/Black&lt;/material&gt;</span><br><span class="line">      &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">      &lt;joint name=&quot;$&#123;name&#125;_wheel2base_link&quot; type=&quot;continuous&quot;&gt;</span><br><span class="line">        &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">        &lt;child link=&quot;$&#123;name&#125;_wheel&quot; /&gt;</span><br><span class="line">        &lt;origin xyz=&quot;0 $&#123;flag * base_link_radius&#125; $&#123;-(earth_space + base_link_length / 2 - wheel_radius) &#125;&quot; /&gt;</span><br><span class="line">        &lt;axis xyz=&quot;0 1 0&quot; /&gt;</span><br><span class="line">      &lt;/joint&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line">    &lt;xacro:add_wheels name=&quot;left&quot; flag=&quot;1&quot; /&gt;</span><br><span class="line">    &lt;xacro:add_wheels name=&quot;right&quot; flag=&quot;-1&quot; /&gt;</span><br><span class="line">    &lt;!-- 支撑轮 --&gt;</span><br><span class="line">    &lt;!-- 支撑轮属性 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_wheel_radius&quot; value=&quot;0.0075&quot; /&gt; &lt;!-- 支撑轮半径 --&gt;</span><br><span class="line">    &lt;xacro:property name=&quot;support_wheel_mass&quot; value=&quot;0.01&quot; /&gt;</span><br><span class="line">    &lt;!-- 支撑轮宏 --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;add_support_wheel&quot; params=&quot;name flag&quot; &gt;</span><br><span class="line">      &lt;link name=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">        &lt;visual&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;sphere radius=&quot;$&#123;support_wheel_radius&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">            &lt;material name=&quot;black&quot; /&gt;</span><br><span class="line">        &lt;/visual&gt;</span><br><span class="line">        &lt;collision&gt;</span><br><span class="line">            &lt;geometry&gt;</span><br><span class="line">                &lt;sphere radius=&quot;$&#123;support_wheel_radius&#125;&quot; /&gt;</span><br><span class="line">            &lt;/geometry&gt;</span><br><span class="line">            &lt;origin xyz=&quot;0 0 0&quot; rpy=&quot;0 0 0&quot; /&gt;</span><br><span class="line">        &lt;/collision&gt;</span><br><span class="line">        &lt;xacro:sphere_inertial_matrix m=&quot;$&#123;support_wheel_mass&#125;&quot; r=&quot;$&#123;support_wheel_radius&#125;&quot; /&gt;</span><br><span class="line">      &lt;/link&gt;</span><br><span class="line">      &lt;gazebo reference=&quot;$&#123;name&#125;_wheel&quot;&gt;</span><br><span class="line">          &lt;material&gt;Gazebo/Black&lt;/material&gt;</span><br><span class="line">      &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">      &lt;joint name=&quot;$&#123;name&#125;_wheel2base_link&quot; type=&quot;continuous&quot;&gt;</span><br><span class="line">          &lt;parent link=&quot;base_link&quot; /&gt;</span><br><span class="line">          &lt;child link=&quot;$&#123;name&#125;_wheel&quot; /&gt;</span><br><span class="line">          &lt;origin xyz=&quot;$&#123;flag * (base_link_radius - support_wheel_radius)&#125; 0 $&#123;-(base_link_length / 2 + earth_space / 2)&#125;&quot; /&gt;</span><br><span class="line">          &lt;axis xyz=&quot;1 1 1&quot; /&gt;</span><br><span class="line">      &lt;/joint&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xacro:add_support_wheel name=&quot;front&quot; flag=&quot;1&quot; /&gt;</span><br><span class="line">    &lt;xacro:add_support_wheel name=&quot;back&quot; flag=&quot;-1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>要想要底盘实现机械运动到目前为止还是远远不够的，必须再加上控制的代码才能实现小车的运动。</p>
<p>摄像头控制代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_sensors&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">  &lt;!-- 被引用的link --&gt;</span><br><span class="line">  &lt;gazebo reference=&quot;camera&quot;&gt;</span><br><span class="line">    &lt;!-- 类型设置为 camara --&gt;</span><br><span class="line">    &lt;sensor type=&quot;camera&quot; name=&quot;camera_node&quot;&gt;</span><br><span class="line">      &lt;update_rate&gt;30.0&lt;/update_rate&gt; &lt;!-- 更新频率 --&gt;</span><br><span class="line">      &lt;!-- 摄像头基本信息设置 --&gt;</span><br><span class="line">      &lt;camera name=&quot;head&quot;&gt;</span><br><span class="line">        &lt;horizontal_fov&gt;1.3962634&lt;/horizontal_fov&gt;</span><br><span class="line">        &lt;image&gt;</span><br><span class="line">          &lt;width&gt;1280&lt;/width&gt;</span><br><span class="line">          &lt;height&gt;720&lt;/height&gt;</span><br><span class="line">          &lt;format&gt;R8G8B8&lt;/format&gt;</span><br><span class="line">        &lt;/image&gt;</span><br><span class="line">        &lt;clip&gt;</span><br><span class="line">          &lt;near&gt;0.02&lt;/near&gt;</span><br><span class="line">          &lt;far&gt;300&lt;/far&gt;</span><br><span class="line">        &lt;/clip&gt;</span><br><span class="line">        &lt;noise&gt;</span><br><span class="line">          &lt;type&gt;gaussian&lt;/type&gt;</span><br><span class="line">          &lt;mean&gt;0.0&lt;/mean&gt;</span><br><span class="line">          &lt;stddev&gt;0.007&lt;/stddev&gt;</span><br><span class="line">        &lt;/noise&gt;</span><br><span class="line">      &lt;/camera&gt;</span><br><span class="line">      &lt;!-- 核心插件 --&gt;</span><br><span class="line">      &lt;plugin name=&quot;gazebo_camera&quot; filename=&quot;libgazebo_ros_camera.so&quot;&gt;</span><br><span class="line">        &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;</span><br><span class="line">        &lt;updateRate&gt;0.0&lt;/updateRate&gt;</span><br><span class="line">        &lt;cameraName&gt;/camera&lt;/cameraName&gt;</span><br><span class="line">        &lt;imageTopicName&gt;image_raw&lt;/imageTopicName&gt;</span><br><span class="line">        &lt;cameraInfoTopicName&gt;camera_info&lt;/cameraInfoTopicName&gt;</span><br><span class="line">        &lt;frameName&gt;camera&lt;/frameName&gt;</span><br><span class="line">        &lt;hackBaseline&gt;0.07&lt;/hackBaseline&gt;</span><br><span class="line">        &lt;distortionK1&gt;0.0&lt;/distortionK1&gt;</span><br><span class="line">        &lt;distortionK2&gt;0.0&lt;/distortionK2&gt;</span><br><span class="line">        &lt;distortionK3&gt;0.0&lt;/distortionK3&gt;</span><br><span class="line">        &lt;distortionT1&gt;0.0&lt;/distortionT1&gt;</span><br><span class="line">        &lt;distortionT2&gt;0.0&lt;/distortionT2&gt;</span><br><span class="line">      &lt;/plugin&gt;</span><br><span class="line">    &lt;/sensor&gt;</span><br><span class="line">  &lt;/gazebo&gt;</span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>雷达控制代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_sensors&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 雷达 --&gt;</span><br><span class="line">  &lt;gazebo reference=&quot;laser&quot;&gt;</span><br><span class="line">    &lt;sensor type=&quot;ray&quot; name=&quot;rplidar&quot;&gt;</span><br><span class="line">      &lt;pose&gt;0 0 0 0 0 0&lt;/pose&gt;</span><br><span class="line">      &lt;visualize&gt;true&lt;/visualize&gt;</span><br><span class="line">      &lt;update_rate&gt;5.5&lt;/update_rate&gt;</span><br><span class="line">      &lt;ray&gt;</span><br><span class="line">        &lt;scan&gt;</span><br><span class="line">          &lt;horizontal&gt;</span><br><span class="line">            &lt;samples&gt;360&lt;/samples&gt;</span><br><span class="line">            &lt;resolution&gt;1&lt;/resolution&gt;</span><br><span class="line">            &lt;min_angle&gt;-3.1415926&lt;/min_angle&gt;</span><br><span class="line">            &lt;max_angle&gt;3.1415926&lt;/max_angle&gt;</span><br><span class="line">          &lt;/horizontal&gt;</span><br><span class="line">        &lt;/scan&gt;</span><br><span class="line">        &lt;range&gt;</span><br><span class="line">          &lt;min&gt;0.10&lt;/min&gt;</span><br><span class="line">          &lt;max&gt;30.0&lt;/max&gt;</span><br><span class="line">          &lt;resolution&gt;0.01&lt;/resolution&gt;</span><br><span class="line">        &lt;/range&gt;</span><br><span class="line">        &lt;noise&gt;</span><br><span class="line">          &lt;type&gt;gaussian&lt;/type&gt;</span><br><span class="line">          &lt;mean&gt;0.0&lt;/mean&gt;</span><br><span class="line">          &lt;stddev&gt;0.01&lt;/stddev&gt;</span><br><span class="line">        &lt;/noise&gt;</span><br><span class="line">      &lt;/ray&gt;</span><br><span class="line">      &lt;plugin name=&quot;gazebo_rplidar&quot; filename=&quot;libgazebo_ros_laser.so&quot;&gt;</span><br><span class="line">        &lt;topicName&gt;/scan&lt;/topicName&gt;</span><br><span class="line">        &lt;frameName&gt;laser&lt;/frameName&gt;</span><br><span class="line">      &lt;/plugin&gt;</span><br><span class="line">    &lt;/sensor&gt;</span><br><span class="line">  &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>最后是连接起整个小车的综合代码，可以理解为一个将各个组件拼接在一起的文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 组合小车底盘与摄像头 --&gt;</span><br><span class="line">&lt;robot name=&quot;mycar&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;base.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;car.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;camera.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;laser.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;car_move.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;ctrl_camera.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;ctrl_laser.xacro&quot; /&gt;</span><br><span class="line">    &lt;xacro:include filename=&quot;kinect.xacro&quot; /&gt;</span><br><span class="line">&lt;/robot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>小车的物理属性都创建好了之后就可以让他按照一定的物理属性运动啦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;robot name=&quot;my_car_move&quot; xmlns:xacro=&quot;http://wiki.ros.org/xacro&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 传动实现:用于连接控制器与关节 --&gt;</span><br><span class="line">    &lt;xacro:macro name=&quot;joint_trans&quot; params=&quot;joint_name&quot;&gt;</span><br><span class="line">        &lt;!-- Transmission is important to link the joints and the controller --&gt;</span><br><span class="line">        &lt;transmission name=&quot;$&#123;joint_name&#125;_trans&quot;&gt;</span><br><span class="line">            &lt;type&gt;transmission_interface/SimpleTransmission&lt;/type&gt;</span><br><span class="line">            &lt;joint name=&quot;$&#123;joint_name&#125;&quot;&gt;</span><br><span class="line">                &lt;hardwareInterface&gt;hardware_interface/VelocityJointInterface&lt;/hardwareInterface&gt;</span><br><span class="line">            &lt;/joint&gt;</span><br><span class="line">            &lt;actuator name=&quot;$&#123;joint_name&#125;_motor&quot;&gt;</span><br><span class="line">                &lt;hardwareInterface&gt;hardware_interface/VelocityJointInterface&lt;/hardwareInterface&gt;</span><br><span class="line">                &lt;mechanicalReduction&gt;1&lt;/mechanicalReduction&gt;</span><br><span class="line">            &lt;/actuator&gt;</span><br><span class="line">        &lt;/transmission&gt;</span><br><span class="line">    &lt;/xacro:macro&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 每一个驱动轮都需要配置传动装置 --&gt;</span><br><span class="line">    &lt;xacro:joint_trans joint_name=&quot;left_wheel2base_link&quot; /&gt;</span><br><span class="line">    &lt;xacro:joint_trans joint_name=&quot;right_wheel2base_link&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 控制器 --&gt;</span><br><span class="line">    &lt;gazebo&gt;</span><br><span class="line">        &lt;plugin name=&quot;differential_drive_controller&quot; filename=&quot;libgazebo_ros_diff_drive.so&quot;&gt;</span><br><span class="line">            &lt;rosDebugLevel&gt;Debug&lt;/rosDebugLevel&gt;</span><br><span class="line">            &lt;publishWheelTF&gt;true&lt;/publishWheelTF&gt;</span><br><span class="line">            &lt;robotNamespace&gt;/&lt;/robotNamespace&gt;</span><br><span class="line">            &lt;publishTf&gt;1&lt;/publishTf&gt;</span><br><span class="line">            &lt;publishWheelJointState&gt;true&lt;/publishWheelJointState&gt;</span><br><span class="line">            &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;</span><br><span class="line">            &lt;updateRate&gt;100.0&lt;/updateRate&gt;</span><br><span class="line">            &lt;legacyMode&gt;true&lt;/legacyMode&gt;</span><br><span class="line">            &lt;leftJoint&gt;left_wheel2base_link&lt;/leftJoint&gt; &lt;!-- 左轮 --&gt;</span><br><span class="line">            &lt;rightJoint&gt;right_wheel2base_link&lt;/rightJoint&gt; &lt;!-- 右轮 --&gt;</span><br><span class="line">            &lt;wheelSeparation&gt;$&#123;base_link_radius * 2&#125;&lt;/wheelSeparation&gt; &lt;!-- 车轮间距 --&gt;</span><br><span class="line">            &lt;wheelDiameter&gt;$&#123;wheel_radius * 2&#125;&lt;/wheelDiameter&gt; &lt;!-- 车轮直径 --&gt;</span><br><span class="line">            &lt;broadcastTF&gt;1&lt;/broadcastTF&gt;</span><br><span class="line">            &lt;wheelTorque&gt;30&lt;/wheelTorque&gt;</span><br><span class="line">            &lt;wheelAcceleration&gt;1.8&lt;/wheelAcceleration&gt;</span><br><span class="line">            &lt;commandTopic&gt;/cmd_vel&lt;/commandTopic&gt; &lt;!-- 运动控制话题 --&gt;</span><br><span class="line">            &lt;odometryFrame&gt;odom&lt;/odometryFrame&gt; </span><br><span class="line">            &lt;odometryTopic&gt;/odom&lt;/odometryTopic&gt; &lt;!-- 里程计话题 --&gt;</span><br><span class="line">            &lt;robotBaseFrame&gt;base_footprint&lt;/robotBaseFrame&gt; &lt;!-- 根坐标系 --&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/gazebo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/robot&gt;</span><br></pre></td></tr></table></figure>

<p>具体的API也可以仿照官网Wiki的文件自己配置，配置过程无非就是把调用的借口放在一个实现方式的里面，再加上参数就可以啦。</p>
<p>emm，URDF的文件找不到在哪了，可能是之前重装系统的时候删掉了，毕竟现在展示的代码都是在那之后又自己写的。。所以说有好多都没有加注释。。。</p>
<p>其实配置仿真大部分都用的是官方的接口，所以说难度不大，要说有难度的还得是自己写适配于自己的设备的代码，到时候不仅要运动学分析，正逆解算还得学矩阵论相关，坐标变换等，这都是我入门阶段所了解到的一些内容，具体应用到实际的话肯定不止我纸面上写的这么一点而已，所以说学无止境。</p>
<p>配置查分小车的launch文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;amcl&quot;</span> <span class="attr">type</span>=<span class="string">&quot;amcl&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amcl&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Publish scans from best pose at a max of 10 Hz --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_model_type&quot;</span> <span class="attr">value</span>=<span class="string">&quot;diff&quot;</span>/&gt;</span><span class="comment">&lt;!-- 里程计模式为差分 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha5&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;transform_tolerance&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;gui_publish_rate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10.0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_max_beams&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;min_particles&quot;</span> <span class="attr">value</span>=<span class="string">&quot;500&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;max_particles&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5000&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;kld_err&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;kld_z&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.99&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- translation std dev, m --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_alpha4&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_hit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_short&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_z_rand&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_sigma_hit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_lambda_short&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_lambda_short&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_model_type&quot;</span> <span class="attr">value</span>=<span class="string">&quot;likelihood_field&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;param name=&quot;laser_model_type&quot; value=&quot;beam&quot;/&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;laser_likelihood_max_dist&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2.0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;update_min_d&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;update_min_a&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 移植只需修改参数即可 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;odom_frame_id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;odom&quot;</span>/&gt;</span><span class="comment">&lt;!-- 里程计坐标系 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;base_frame_id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;base_footprint&quot;</span>/&gt;</span><span class="comment">&lt;!-- 添加机器人基坐标系 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;global_frame_id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;map&quot;</span>/&gt;</span><span class="comment">&lt;!-- 添加地图坐标系 --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;resample_interval&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;transform_tolerance&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;recovery_alpha_slow&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;recovery_alpha_fast&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后我就按照我文件的默认位置写啦，具体的注释都有讲解，该怎么配置也都写得很详细</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">&lt;!--是否设置为仿真，在仿真环境里面使用  true  --&gt;</span><br><span class="line">&lt;param name=&quot;use_sim_time&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;!-- gampping 节点 --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find my_navigation)/launch/gampping.launch&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- 可以保存 rviz 配置并后期直接使用--&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find my_navigation)/rviz/demo_amcl.rviz&quot;/&gt;</span><br><span class="line">   </span><br><span class="line">    &lt;!-- 将 Urdf 文件的内容加载到参数服务器 --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)/xacro $(find my_gazebo)/xacro/connect.xacro&quot; /&gt;</span><br><span class="line">    &lt;!-- 启动 gazebo --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;&gt;</span><br><span class="line">       &lt;arg name=&quot;world_name&quot; value=&quot;$(find my_gazebo)/worlds/1.world&quot; /&gt;</span><br><span class="line">    &lt;/include&gt; --&gt;</span><br><span class="line">    &lt;!-- 在 gazebo 中显示机器人模型 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gazebo_ros&quot; type=&quot;spawn_model&quot; name=&quot;model&quot; args=&quot;-urdf -model mycar -param robot_description&quot;  /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面的是进行AMCL的代码，接下来是跑gmapping的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">  &lt;!--是否设置为仿真，在仿真环境里面使用  true  --&gt;</span><br><span class="line">  &lt;param name=&quot;use_sim_time&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;include file=&quot;$(find my_navigation)/launch/gampping.launch&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- 可以保存 rviz 配置并后期直接使用--&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find my_navigation)/rviz/demo1.rviz&quot;/&gt;</span><br><span class="line">   </span><br><span class="line">    &lt;!-- 将 Urdf 文件的内容加载到参数服务器 --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)/xacro $(find my_gazebo)/xacro/connect.xacro&quot; /&gt;</span><br><span class="line">    &lt;!-- 启动 gazebo --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;&gt;</span><br><span class="line">       &lt;arg name=&quot;world_name&quot; value=&quot;$(find my_gazebo)/worlds/1.world&quot; /&gt;</span><br><span class="line">    &lt;/include&gt; --&gt;</span><br><span class="line">    &lt;!-- 在 gazebo 中显示机器人模型 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gazebo_ros&quot; type=&quot;spawn_model&quot; name=&quot;model&quot; args=&quot;-urdf -model mycar -param robot_description&quot;  /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要配合gmapping的配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- gampping 节点 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gmapping&quot; type=&quot;slam_gmapping&quot; name=&quot;slam_gmapping&quot; output=&quot;screen&quot;&gt;</span><br><span class="line">      &lt;!-- 设置雷达话题 --&gt;</span><br><span class="line">      &lt;remap from=&quot;scan&quot; to=&quot;scan&quot;/&gt;</span><br><span class="line">      &lt;!-- 关键参数  三个坐标系 --&gt;</span><br><span class="line">      &lt;param name=&quot;base_frame&quot; value=&quot;base_footprint&quot;/&gt;&lt;!--底盘坐标系 设置为基坐标系名字 在这里是 base_footprint --&gt;</span><br><span class="line">      &lt;param name=&quot;odom_frame&quot; value=&quot;odom&quot;/&gt; &lt;!--里程计坐标系--&gt;</span><br><span class="line">      &lt;param name=&quot;map_update_interval&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">      &lt;!-- 其他参数一般设置为默认即可（下面为默认参数值） --&gt;</span><br><span class="line">      &lt;param name=&quot;maxUrange&quot; value=&quot;16.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;sigma&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;kernelSize&quot; value=&quot;1&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lstep&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;astep&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;iterations&quot; value=&quot;5&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lsigma&quot; value=&quot;0.075&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;ogain&quot; value=&quot;3.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lskip&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;srr&quot; value=&quot;0.1&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;srt&quot; value=&quot;0.2&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;str&quot; value=&quot;0.1&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;stt&quot; value=&quot;0.2&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;linearUpdate&quot; value=&quot;1.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;angularUpdate&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;temporalUpdate&quot; value=&quot;3.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;resampleThreshold&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;particles&quot; value=&quot;30&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;xmin&quot; value=&quot;-50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;ymin&quot; value=&quot;-50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;xmax&quot; value=&quot;50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;ymax&quot; value=&quot;50.0&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;delta&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;llsamplerange&quot; value=&quot;0.01&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;llsamplestep&quot; value=&quot;0.01&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lasamplerange&quot; value=&quot;0.005&quot;/&gt;</span><br><span class="line">      &lt;param name=&quot;lasamplestep&quot; value=&quot;0.005&quot;/&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"></span><br><span class="line">    &lt;node pkg=&quot;joint_state_publisher&quot; name=&quot;joint_state_publisher&quot; type=&quot;joint_state_publisher&quot; /&gt;</span><br><span class="line">    &lt;node pkg=&quot;robot_state_publisher&quot; name=&quot;robot_state_publisher&quot; type=&quot;robot_state_publisher&quot; /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>建图操作和保存地图操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- 设置地图的配置文件 --&gt;</span><br><span class="line">    &lt;arg name=&quot;map&quot; default=&quot;nav.yaml&quot; /&gt;</span><br><span class="line">    &lt;!-- 运行地图服务器，并且加载设置的地图--&gt;</span><br><span class="line">    &lt;node name=&quot;map_server&quot; pkg=&quot;map_server&quot; type=&quot;map_server&quot; args=&quot;$(find my_navigation)/map/$(arg map)&quot;/&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>然后是保存操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;arg name=&quot;filename&quot; value=&quot;$(find my_navigation)/map/nav&quot; /&gt;</span><br><span class="line">    &lt;node name=&quot;map_save&quot; pkg=&quot;map_server&quot; type=&quot;map_saver&quot; args=&quot;-f $(arg filename)&quot; /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>move_base相关代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line"></span><br><span class="line">    &lt;node pkg=&quot;move_base&quot; type=&quot;move_base&quot; respawn=&quot;false&quot; name=&quot;move_base&quot; output=&quot;screen&quot; clear_params=&quot;true&quot;&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/costmap_common_params.yaml&quot; command=&quot;load&quot; ns=&quot;global_costmap&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/costmap_common_params.yaml&quot; command=&quot;load&quot; ns=&quot;local_costmap&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/local_costmap_params.yaml&quot; command=&quot;load&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/global_costmap_params.yaml&quot; command=&quot;load&quot; /&gt;</span><br><span class="line">        &lt;rosparam file=&quot;$(find my_navigation)/param/base_local_planner_params.yaml&quot; command=&quot;load&quot; /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"></span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后一步是跑整个建图之后的导航的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- 设置地图的配置文件 --&gt;</span><br><span class="line">    &lt;arg name=&quot;map&quot; default=&quot;nav.yaml&quot; /&gt;</span><br><span class="line">    &lt;!-- 运行地图服务器，并且加载设置的地图--&gt;</span><br><span class="line">    &lt;node name=&quot;map_server&quot; pkg=&quot;map_server&quot; type=&quot;map_server&quot; args=&quot;$(find roscar_navigation)/map/$(arg map)&quot;/&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- 启动SLAM --&gt;</span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find roscar_navigation)/launch/gmapping.launch&quot; /&gt; --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- 启动AMCL节点 二维地图定位 --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find roscar_navigation)/launch/amcl_diff.launch&quot; /&gt;</span><br><span class="line">    &lt;!-- 使用官方虚拟定位兼容AMCL输出 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;fake_localization&quot; type=&quot;fake_localization&quot; name=&quot;fake_localization&quot; output=&quot;screen&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 运行move_base节点 --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find roscar_navigation)/launch/move_base.launch&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;node pkg=&quot;joint_state_publisher&quot; name=&quot;joint_state_publisher&quot; type=&quot;joint_state_publisher&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;robot_state_publisher&quot; name=&quot;robot_state_publisher&quot; type=&quot;robot_state_publisher&quot; /&gt; --&gt;</span><br><span class="line">    &lt;node name=&quot;robot_state_publisher&quot; pkg=&quot;robot_state_publisher&quot; type=&quot;robot_state_publisher&quot;  output=&quot;screen&quot; &gt;</span><br><span class="line">        &lt;param name=&quot;publish_frequency&quot; type=&quot;double&quot; value=&quot;50.0&quot; /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- 可以保存 rviz 配置并后期直接使用--&gt; </span><br><span class="line">    &lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find roscar_navigation)/rviz/demo_self_move.rviz&quot;/&gt;  </span><br><span class="line">    &lt;!-- 将 Urdf 文件的内容加载到参数服务器 --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)/xacro $(find roscar_gazebo)/xacro/connect.xacro&quot; /&gt;</span><br><span class="line">    &lt;!-- 启动 gazebo --&gt;</span><br><span class="line">    &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- &lt;include file=&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;&gt;</span><br><span class="line">       &lt;arg name=&quot;world_name&quot; value=&quot;$(find roscar_gazebo)/worlds/roscar_demo.world&quot; /&gt;</span><br><span class="line">    &lt;/include&gt; --&gt;</span><br><span class="line">    &lt;!-- 在 gazebo 中显示机器人模型 --&gt;</span><br><span class="line">    &lt;node pkg=&quot;gazebo_ros&quot; type=&quot;spawn_model&quot; name=&quot;model&quot; args=&quot;-urdf -model mycar -param robot_description&quot;  /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 对于虚拟定位，需要设置一个/odom与/map之间的静态坐标变换  前六个参数分别是xyz和rpy,10代表10ms刷新一次--&gt;</span><br><span class="line">    &lt;node pkg=&quot;tf&quot; type=&quot;static_transform_publisher&quot; name=&quot;map_odom_broadcaster&quot; args=&quot;0 0 0 0 0 0 /map /odom 10&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/launch&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>具体效果如图</p>
<p><img src="https://img-blog.csdnimg.cn/56caad7b9d7e4fdcb690f43dc869a50e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br><img src="https://img-blog.csdnimg.cn/07fa663409bd47e18a958ef15227ca2f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASFdfTXJSaWdodA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<p>写在最后：以上代码的代码文件可以问我要，具体可以实现导航的在roscar_navigation里面launch文件的self_move.launch 中，其他补充的话还需要完善</p>
<p>未完待续。。。。。。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://baitang-hou.github.io/2021/04/18/ROS%E4%B8%8ESTM32%E9%80%9A%E4%BF%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/18/ROS%E4%B8%8ESTM32%E9%80%9A%E4%BF%A1/" class="post-title-link" itemprop="url">ROS&STM32通信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-18 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-18T00:00:00+08:00">2021-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-19 15:55:28" itemprop="dateModified" datetime="2022-01-19T15:55:28+08:00">2022-01-19</time>
              </span>

          
            <span id="/2021/04/18/ROS%E4%B8%8ESTM32%E9%80%9A%E4%BF%A1/" class="post-meta-item leancloud_visitors" data-flag-title="ROS&STM32通信" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/18/ROS%E4%B8%8ESTM32%E9%80%9A%E4%BF%A1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/18/ROS%E4%B8%8ESTM32%E9%80%9A%E4%BF%A1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ROS与STM32串口通信"><a href="#ROS与STM32串口通信" class="headerlink" title="ROS与STM32串口通信"></a>ROS与STM32串口通信</h1><p>对于&#x3D;&#x3D;不是&#x3D;&#x3D;noetic版本的ros来说，是集成了serial功能包的，但是笔者在实践中发现，最新的noetic版本并没有serial功能包，也就是说通过命令</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-noetic-serial</span><br></pre></td></tr></table></figure>
<p>下载是&#x3D;&#x3D;行不通的&#x3D;&#x3D;&#x3D;，只会得到这样的结果<img src="https://img-blog.csdnimg.cn/20210418154917549.png" alt="在这里插入图片描述"><br>其他版本的话可以直接下载对应功能包</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-版本-serial</span><br></pre></td></tr></table></figure>

<p>那么对于noetic版本我们应该怎样下载呢？</p>
<p>首先我们借用已经开源的文件下载，在你的功能包下的src目录执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="attr">https</span>:<span class="comment">//github.com/wjwwood/serial.git</span></span><br></pre></td></tr></table></figure>
<p>然后在下载的文件夹内进行编译下载</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd serial</span><br><span class="line">make</span><br><span class="line">make test</span><br><span class="line">make doc</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>如果报错make无效什么的话，可以先执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install doxygen-latex</span><br></pre></td></tr></table></figure>
<p>然后再返回上面的过程。</p>
<p>最后得到以下结果<br><img src="https://img-blog.csdnimg.cn/20210418164420617.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210418155955801.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后进入serial目录，在CMakeLists.txt文件中修改以下内容为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">include_directories</span>(include  $&#123;catkin_INCLUDE_DIRS&#125;)</span><br></pre></td></tr></table></figure>
<p>修改后的结果如图所示：<br><img src="https://img-blog.csdnimg.cn/20210418160513371.png" alt="在这里插入图片描述"><br>最后就是在你所需要设置串口的功能包内的package.xml文件中添加对应依赖即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;build_depend&gt;serial&lt;/build_depend&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">build_export_depend</span>&gt;</span>serial<span class="tag">&lt;/<span class="name">build_export_depend</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>serial<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>CMakelist.txt文件的find语句中添加serial即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">find_package</span>(catkin <span class="variable constant_">REQUIRED</span> <span class="variable constant_">COMPONENTS</span></span><br><span class="line">  巴拉巴拉</span><br><span class="line">  </span><br><span class="line">  serial</span><br><span class="line">  </span><br><span class="line">  巴拉巴拉</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>或者你可以直接创建一个依赖serial的功能包，具体如下<br>在src目录下打开终端，输入以下内容分即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">catkin_create_pkg roscar_serial roscpp rospy std_msgs serial</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到的结果如图所示</p>
<p><img src="https://img-blog.csdnimg.cn/20210418162020640.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>最后对应ros的文件可以&#x3D;&#x3D;参考&#x3D;&#x3D;匿名科创的代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//serial_port.cpp</span></span><br><span class="line">#include &lt;ros/ros.<span class="property">h</span>&gt;</span><br><span class="line">#include <span class="string">&quot;serial/serial.h&quot;</span></span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;math.<span class="property">h</span>&gt;</span><br><span class="line">#include <span class="string">&quot;ano_tc_v4/sdk_ano_tc_v4.hpp&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">SDK_ANO_TC_V4</span> ano_tc;</span><br><span class="line"><span class="attr">serial</span>::<span class="title class_">Serial</span> sp;</span><br><span class="line"></span><br><span class="line">int <span class="title function_">main</span>(<span class="params">int argc, char** argv</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">ros</span>::<span class="title function_">init</span>(argc, argv, <span class="string">&quot;serial_port&quot;</span>);</span><br><span class="line">    <span class="attr">ros</span>::<span class="title class_">NodeHandle</span> nh;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    ano_tc.<span class="title function_">set_dev</span>(&amp;sp,<span class="string">&quot;/dev/ttyUSB1&quot;</span>,<span class="number">57600</span>);</span><br><span class="line">    ano_tc.<span class="title function_">open_dev</span>(&amp;sp);</span><br><span class="line">    <span class="comment">// simulate sin data</span></span><br><span class="line">    <span class="attr">ros</span>::<span class="title class_">Rate</span> <span class="title function_">loop_rate</span>(<span class="number">5760</span>);	<span class="comment">// </span></span><br><span class="line">    <span class="keyword">while</span> (<span class="attr">ros</span>::<span class="title function_">ok</span>())</span><br><span class="line">    &#123;   </span><br><span class="line">        ano_tc.<span class="title function_">receive_info_from_ano_tc</span>(&amp;sp);</span><br><span class="line">        <span class="attr">ros</span>::<span class="title function_">spinOnce</span>();</span><br><span class="line">        loop_rate.<span class="title function_">sleep</span>();</span><br><span class="line">    &#125;</span><br><span class="line">                   </span><br><span class="line">    ano_tc.<span class="title function_">close_dev</span>(&amp;sp);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/tsuibeyond/article/details/106744745">文章链接</a><br>或者<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhao_ke_xue/article/details/105493907">参考以下内容</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://baitang-hou.github.io/2021/04/17/Ubuntu20.04%E5%AE%89%E8%A3%85ROS%20Noetic%E7%89%88%E6%9C%AC%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/17/Ubuntu20.04%E5%AE%89%E8%A3%85ROS%20Noetic%E7%89%88%E6%9C%AC%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">Ubuntu20.04安装ROS noetic教程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-17 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-17T00:00:00+08:00">2021-04-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-19 15:55:21" itemprop="dateModified" datetime="2022-01-19T15:55:21+08:00">2022-01-19</time>
              </span>

          
            <span id="/2021/04/17/Ubuntu20.04%E5%AE%89%E8%A3%85ROS%20Noetic%E7%89%88%E6%9C%AC%E6%95%99%E7%A8%8B/" class="post-meta-item leancloud_visitors" data-flag-title="Ubuntu20.04安装ROS noetic教程" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/17/Ubuntu20.04%E5%AE%89%E8%A3%85ROS%20Noetic%E7%89%88%E6%9C%AC%E6%95%99%E7%A8%8B/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/17/Ubuntu20.04%E5%AE%89%E8%A3%85ROS%20Noetic%E7%89%88%E6%9C%AC%E6%95%99%E7%A8%8B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Ubuntu20-04安装ros-noetic版本教程"><a href="#Ubuntu20-04安装ros-noetic版本教程" class="headerlink" title="Ubuntu20.04安装ros noetic版本教程"></a>Ubuntu20.04安装ros noetic版本教程</h2><p>当我们进入ubuntu系统后首先要安装ros的完全版以确保我们正常学习ros的一些内容更方便，接下来我将带着大家安装ros最新版本（noetic版本）</p>
<p>&#x3D;&#x3D;此教程同样适用于装载了ubuntu20.04版本的树莓派端（ubuntu20.04系统）&#x3D;&#x3D;</p>
<p>第一步设置软件源和秘钥，在这里我推荐使用官方给的软件源，这样安装虽然慢但是可以避免很多安装不全的问题</p>
<p>在这里可以设置电脑端的软件源（我在测试树莓派时没有设置也可以安装）</p>
<p>首先设置软件源（官方），执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo sh -c <span class="string">&#x27;echo &quot;deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>添加秘钥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver <span class="string">&#x27;hkp://keyserver.ubuntu.com:80&#x27;</span> --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>确保软件最新，执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">或者</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>安装ros完全版</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-noetic-desktop-full</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x3D;&#x3D;如果提示安装错误的话请使用手机热点，这样的成功率会高很多&#x3D;&#x3D;<br>进入树莓派端的方法：电脑端Windows使用putty软件或者Ubuntu使用ssh均可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh 树莓派名字@树莓派IP地址</span><br></pre></td></tr></table></figure>
<p>接下来就是漫长的等待<br>。<br>。<br>。<br>。<br>。<br>。<br>安装完成后要进行环境变量设置<br>在home目录的隐藏文件.bashrc里面添加source命令可以保证我们启动ros时可以正常使用</p>
<pre><code class="j">echo &quot;source /opt/ros/noetic/setup.bash&quot; &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>
<p>如果出现使用roswtf出现错误的情况可以参考<a target="_blank" rel="noopener" href="https://www.guyuehome.com/12640">以下文章</a></p>
<p>等待完成后就可以使用ros啦！！！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://baitang-hou.github.io/2021/04/17/ROS%E4%B8%BB%E4%BB%8E%E6%9C%BA%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/17/ROS%E4%B8%BB%E4%BB%8E%E6%9C%BA%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">ROS 主从机设置方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-17 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-17T00:00:00+08:00">2021-04-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-10 11:02:17" itemprop="dateModified" datetime="2022-01-10T11:02:17+08:00">2022-01-10</time>
              </span>

          
            <span id="/2021/04/17/ROS%E4%B8%BB%E4%BB%8E%E6%9C%BA%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95/" class="post-meta-item leancloud_visitors" data-flag-title="ROS 主从机设置方法" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/17/ROS%E4%B8%BB%E4%BB%8E%E6%9C%BA%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/17/ROS%E4%B8%BB%E4%BB%8E%E6%9C%BA%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ROS的主从机设置方法"><a href="#ROS的主从机设置方法" class="headerlink" title="ROS的主从机设置方法"></a>ROS的主从机设置方法</h2><p>为了确保ros在树莓派上和电脑端实施通讯，在这里我们要设置他们的主从。<br>&#x3D;&#x3D;设置主从机时一定要确保在同一局域网下，否则不成功&#x3D;&#x3D;<br>这我们一般设置树莓派为主机，电脑端为从机。<br>本教程建议使用ubuntu20.04系统，ros版本为noetic<br>首先要在你的电脑端和树莓派端执行以下语句并修改里面的一些内容<br>（具体进入树莓派端的方法是使用ssh，参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_53683803/article/details/115564691">文章的树莓派部分，或者自行百度</a>）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/hosts</span><br></pre></td></tr></table></figure>
<p>首先会进入以下界面（我以自己的用户名hbt和ubuntu为例，实际情况按自己需要修改即可）<br>图片:<img src="https://img-blog.csdnimg.cn/2021041716515623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在#一行上面添加你的主机地址和从机地址，然后按Ctrl+x保存以后退出，然后进入.bashrc文件，执行以下命令:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano .bashrc </span><br></pre></td></tr></table></figure>
<p>结果如下，<img src="https://img-blog.csdnimg.cn/20210417165556802.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>在最后添加以下代码（对应替换即可）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export ROS_HOSTNAME=主机IP（我的是树莓派地址）</span><br><span class="line">export ROS_MASTER_URI=http://主机IP:11311</span><br><span class="line">export ROS_IP=主机IP</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>到这里我们的主机（树莓派）已经配置完成，接下来就是我们的从机电脑端</p>
<p>从机部分（电脑端）：<br>执行以下代码添加IP地址（此过程和树莓派端相同）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/hosts</span><br></pre></td></tr></table></figure>
<p>结果和树莓派端相同<img src="https://img-blog.csdnimg.cn/20210417170104110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>依旧是在#代码上添加你的主机从机IP和用户名称</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit .<span class="property">bashrc</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210417170555105.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>因为我们已经在hosts文件添加了主机的IP，所以可以用名字来代替</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="variable constant_">ROS_HOSTNAME</span>=从机<span class="variable constant_">IP</span></span><br><span class="line"><span class="keyword">export</span> <span class="variable constant_">ROS_MASTER_URI</span>=<span class="attr">http</span>:<span class="comment">//主机IP:11311</span></span><br><span class="line"><span class="keyword">export</span> <span class="variable constant_">ROS_IP</span>=主机<span class="variable constant_">IP</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>到目前为止，配置基本完成，然后就是检验运行是否正确<br>在树莓派端运行roscore</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roscore</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210417171022810.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到运行成功<br>然后在电脑端运行海归仿真器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtlesim_node </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210417171232359.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNjgzODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>运行成功<br>证明主从机配置结束<br>感谢支持，如果有错的地方欢迎指正</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://baitang-hou.github.io/2021/04/04/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85ROS%20Noetic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/01.jpg">
      <meta itemprop="name" content="Hou-baitang">
      <meta itemprop="description" content="用于记录学习生活，成为一个自己想要成为的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="革Mean君">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/04/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85ROS%20Noetic/" class="post-title-link" itemprop="url">树莓派安装ROS Noetic</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-04 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-04T00:00:00+08:00">2021-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-10 11:05:29" itemprop="dateModified" datetime="2022-01-10T11:05:29+08:00">2022-01-10</time>
              </span>

          
            <span id="/2021/04/04/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85ROS%20Noetic/" class="post-meta-item leancloud_visitors" data-flag-title="树莓派安装ROS Noetic" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/04/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85ROS%20Noetic/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/04/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85ROS%20Noetic/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>@[TOC](基于树莓派4b的ros noetic版本下载安装)</p>
<h1 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h1><h2 id="安装引导程序依赖项"><a href="#安装引导程序依赖项" class="headerlink" title="安装引导程序依赖项"></a>安装引导程序依赖项</h2><p>安装引导程序依赖项（Ubuntu）：</p>
<p>Ubuntu或Debian：</p>
<blockquote>
<p>sudo apt-get install python3-rosdep python3-rosinstall-generator python3-vcstool build-essential</p>
</blockquote>
<p>如果您在上面的命令中安装软件包时遇到问题，请确保已按照此处所述，将packages.ros.org debian存储库添加到了您的apt源列表中：noetic &#x2F; Installation &#x2F; Ubuntu＃Installation.2BAC8-Ubuntu.2BAC8-Sources .Setup_your_sources.list</p>
<p>ros官网原文</p>
<p>链接: <a target="_blank" rel="noopener" href="http://wiki.ros.org/noetic/Installation/Source">ros</a>.</p>
<h2 id="初始化rosdep"><a href="#初始化rosdep" class="headerlink" title="初始化rosdep"></a>初始化rosdep</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rosdep init</span><br><span class="line">rosdep update</span><br></pre></td></tr></table></figure>

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先构建核心ROS程序包。<br>创建你的工作空间<br>为了构建核心程序包，您将需要一个catkin工作区。立即创建一个：</p>
<blockquote>
<p>mkdir〜&#x2F; ros_catkin_ws<br>cd〜&#x2F; ros_catkin_ws</p>
</blockquote>
<p>接下来，我们将要下载ROS包的源代码，以便我们可以构建它们。我们将为此使用vcstool。就本指南而言，我们假设您要构建所有Desktop。<br>分别执行下面三条语句</p>
<blockquote>
<p>rosinstall_generator desktop –rosdistro noetic –deps –tar &gt; noetic-desktop.rosinstall</p>
</blockquote>
<blockquote>
<p>mkdir .&#x2F;src</p>
</blockquote>
<blockquote>
<p>vcs import –input noetic-desktop.rosinstall .&#x2F;src</p>
</blockquote>
<p>这会将Desktop软件包的所有源代码下载到〜&#x2F; ros_catkin_ws &#x2F; src目录中。该命令将花费很长时间来下载所有内容。<br>请耐心等待。。。。。</p>
<h3 id="解决依赖关系"><a href="#解决依赖关系" class="headerlink" title="解决依赖关系"></a>解决依赖关系</h3><p>在构建Catkin工作区之前，需要确保平台上具有所有系统依赖项。我们为此使用rosdep工具：</p>
<blockquote>
<p>rosdep install –from-paths.&#x2F;src –ignore-packages-from-source –rosdistro noetic -y</p>
<p>rosdep查看src目录中的所有软件包，并尝试在您的平台上查找并安装它们的依赖项。一段时间后（可能会提示您输入密码），rosdep将完成安装系统依赖项，您可以继续。</p>
</blockquote>
<h3 id="建立工作空间"><a href="#建立工作空间" class="headerlink" title="建立工作空间"></a>建立工作空间</h3><p>到目前为止，您已经有了一个包含所有源代码的工作区，并且已经安装了所有必需的系统依赖项。现在该构建代码了。ROS 1软件包使用CMake; 但是，手工调用所有包装上的cmake会很麻烦。我们可以使用一些工具来按正确的顺序构建所有软件包。我们将使用的工具是catkin_make_isolated。</p>
<blockquote>
<p>.&#x2F;src&#x2F;catkin&#x2F;bin&#x2F;catkin_make_isolated –install -DCMAKE_BUILD_TYPE&#x3D;Release</p>
</blockquote>
<p>注意：如果发现缺少与EMPY模块有关的错误，则可能是使用Python 2而不是Python 3构建的。要确保使用的是Python 3，请将以下内容附加到上面的命令中。如果您在其他地方安装了Python 3，请相应地更新路径。<br>也即执行以下语句：</p>
<blockquote>
<p>.&#x2F;src&#x2F;catkin&#x2F;bin&#x2F;catkin_make_isolated –install -DPYTHON_EXECUTABLE &#x3D; &#x2F; usr &#x2F; bin &#x2F; python3</p>
</blockquote>
<p>这要花费大量的时间来完成</p>
<p>。<br>。<br>。<br>。<br>。<br>。<br>。<br>。<br>。</p>
<p>上面的命令完成后，它将把所有内容都安装到〜&#x2F; ros_catkin_ws &#x2F; install_isolated中。如果您想在其他地方安装，请在catkin_make_isolated调用中添加–install-space path &#x2F; to &#x2F; somewhere &#x2F; else。</p>
<p>要在没有Ubuntu的机器人上使用，建议像Ubuntu软件包一样将编译后的代码安装到&#x2F; opt &#x2F; ros &#x2F; noetic中。当然，不要在Ubuntu中执行此操作，因为这些软件包会与apt-get软件包发生冲突。</p>
<p>现在，这些软件包应该已经安装到〜&#x2F; ros_catkin_ws &#x2F; install_isolated或使用–install-space参数指定的任何位置。如果查看该目录，将看到已经生成了setup.bash文件。要利用安装在这里的东西，只需简单地获取该文件的源即可，如下所示：</p>
<blockquote>
<p>source ~&#x2F;ros_catkin_ws&#x2F;install_isolated&#x2F;setup.bash</p>
</blockquote>
<p>你也可以直接将他加到.bashrc文件里面</p>
<h2 id="维护源"><a href="#维护源" class="headerlink" title="维护源"></a>维护源</h2><p>如果我们想使源代码保持最新，则必须定期更新rosinstall文件，下载最新源代码并重建工作区</p>
<h2 id="更新您的rosinstall文件"><a href="#更新您的rosinstall文件" class="headerlink" title="更新您的rosinstall文件"></a>更新您的rosinstall文件</h2><p>要更新您的工作区，请首先移动现有的rosinstall文件，以使其不会被覆盖，然后生成更新的版本<br>分别在终端执行下面两个命令：</p>
<blockquote>
<p>mv -i noetic-desktop.rosinstall noetic-desktop.rosinstall.old</p>
</blockquote>
<blockquote>
<p>rosinstall_generator desktop –rosdistro noetic –deps –tar &gt; noetic-desktop.rosinstall</p>
</blockquote>
<p>然后，将新的rosinstall文件与旧版本进行比较，以查看将更新哪些软件包：</p>
<blockquote>
<p>diff -u noetic-desktop.rosinstall noetic-desktop.rosinstall.old</p>
</blockquote>
<h2 id="下载最新资源"><a href="#下载最新资源" class="headerlink" title="下载最新资源"></a>下载最新资源</h2><p>如果您对这些更改感到满意，请将新的rosinstall文件合并到工作空间中并更新您的工作空间：</p>
<blockquote>
<p>vcs import –input noetic-desktop.rosinstall .&#x2F;src</p>
</blockquote>
<h2 id="重建工作区"><a href="#重建工作区" class="headerlink" title="重建工作区"></a>重建工作区</h2><p>现在，工作区是最新的最新资源，请重新构建它：</p>
<blockquote>
<p>.&#x2F;src&#x2F;catkin&#x2F;bin&#x2F;catkin_make_isolated –install</p>
</blockquote>
<p>如果最初在工作空间时指定了–install-space选项，则应在重建工作空间时再次指定它<br>重建工作空间后，您应该再次获取安装文件：</p>
<blockquote>
<p>source ~&#x2F;ros_catkin_ws&#x2F;install_isolated&#x2F;setup.bash</p>
</blockquote>
<p>本文由roswiki改编<br>原文链接: <a target="_blank" rel="noopener" href="http://wiki.ros.org/noetic/Installation/Source">ros</a>.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hou-baitang"
      src="/images/01.jpg">
  <p class="site-author-name" itemprop="name">Hou-baitang</p>
  <div class="site-description" itemprop="description">用于记录学习生活，成为一个自己想要成为的人</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/2914360094@qq.com" title="E-Mail → 2914360094@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hou-baitang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'CHrcBwX6gcXANbBEKYs61u5W-gzGzoHsz',
      appKey     : 'vWEYMt0YeFAFL8Xp2TDI0Lhn',
      placeholder: "快来评论叭~~",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
